#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include "dsp_functions.h"
#include "functions.h"
#include "klessydra_defs.h"

#ifndef accl_test
#define accl_test 1
#endif

#ifndef USE_KLESSYDRA_T
#define USE_KLESSYDRA_T 1
#endif

//  ███╗   ███╗ █████╗ ████████╗███╗   ███╗██╗   ██╗██╗     
//  ████╗ ████║██╔══██╗╚══██╔══╝████╗ ████║██║   ██║██║     
//  ██╔████╔██║███████║   ██║   ██╔████╔██║██║   ██║██║     
//  ██║╚██╔╝██║██╔══██║   ██║   ██║╚██╔╝██║██║   ██║██║     
//  ██║ ╚═╝ ██║██║  ██║   ██║   ██║ ╚═╝ ██║╚██████╔╝███████╗
//  ╚═╝     ╚═╝╚═╝  ╚═╝   ╚═╝   ╚═╝     ╚═╝ ╚═════╝ ╚══════╝

#define SPM_MAX 64
#define SIZE_OF_INT 4
#define N_ROW_1 64
#define N_COL_1 64
#define N_COL_2 64

int m1[N_ROW_1][N_COL_1]={33, 36, 27, 15, 43, 35, 36, 42, 49, 21, 12, 27, 40, 9, 13, 26, 40, 26, 22, 36, 11, 18, 17, 29, 32, 30, 12, 23, 17, 35, 29, 2, 22, 8, 19, 17, 43, 6, 11, 42, 29, 23, 21, 19, 34, 37, 48, 24, 15, 20, 13, 26, 41, 30, 6, 23, 12, 20, 46, 31, 5, 25, 34, 27, 
36, 5, 46, 29, 13, 7, 24, 45, 32, 45, 14, 17, 34, 14, 43, 0, 37, 8, 26, 28, 38, 34, 3, 1, 4, 49, 32, 10, 26, 18, 39, 12, 26, 36, 44, 39, 45, 20, 34, 28, 17, 1, 47, 2, 17, 42, 2, 6, 1, 30, 36, 41, 15, 39, 44, 19, 40, 29, 31, 17, 47, 21, 31, 25, 
9, 27, 17, 6, 47, 3, 36, 15, 6, 33, 19, 24, 28, 21, 32, 29, 3, 19, 20, 18, 8, 15, 40, 49, 46, 23, 18, 45, 46, 1, 21, 5, 29, 38, 14, 28, 41, 0, 43, 0, 34, 14, 24, 14, 37, 6, 43, 41, 27, 15, 9, 36, 32, 1, 37, 28, 25, 7, 24, 21, 8, 45, 29, 37, 
35, 43, 18, 28, 43, 11, 28, 29, 26, 4, 43, 13, 13, 38, 6, 40, 4, 18, 28, 38, 19, 17, 17, 46, 24, 43, 20, 33, 40, 49, 22, 25, 44, 40, 5, 39, 4, 36, 19, 32, 42, 14, 47, 7, 5, 4, 48, 11, 22, 28, 49, 43, 46, 18, 40, 22, 11, 10, 5, 1, 11, 30, 28, 5, 
20, 36, 44, 26, 22, 15, 8, 16, 32, 8, 24, 37, 12, 24, 0, 36, 2, 49, 29, 0, 18, 21, 23, 31, 31, 30, 33, 44, 10, 13, 49, 31, 49, 46, 9, 23, 13, 18, 40, 45, 26, 16, 34, 40, 40, 34, 26, 42, 36, 7, 45, 6, 29, 18, 37, 12, 48, 22, 9, 9, 36, 10, 42, 37, 
6, 1, 13, 22, 21, 5, 19, 49, 21, 4, 39, 11, 40, 17, 5, 28, 27, 0, 34, 8, 20, 24, 22, 19, 46, 31, 30, 34, 42, 22, 22, 0, 25, 35, 22, 49, 40, 42, 48, 13, 48, 40, 24, 40, 9, 31, 19, 36, 32, 5, 44, 4, 29, 19, 23, 26, 0, 5, 10, 42, 29, 34, 43, 5, 
21, 17, 4, 13, 11, 4, 26, 9, 44, 2, 2, 6, 34, 21, 42, 18, 28, 39, 22, 8, 8, 48, 36, 8, 3, 48, 3, 33, 33, 48, 40, 4, 17, 46, 18, 29, 0, 46, 38, 47, 49, 40, 3, 33, 13, 47, 3, 42, 36, 25, 2, 46, 25, 38, 7, 29, 36, 10, 14, 21, 10, 4, 28, 27, 
0, 48, 6, 2, 44, 47, 49, 43, 39, 2, 28, 3, 0, 31, 47, 38, 9, 1, 35, 34, 39, 42, 15, 27, 4, 29, 49, 14, 35, 29, 43, 35, 27, 0, 38, 21, 49, 39, 17, 38, 42, 45, 43, 44, 29, 40, 32, 40, 41, 19, 26, 32, 11, 42, 10, 17, 23, 11, 31, 9, 40, 25, 46, 17, 
27, 34, 40, 26, 24, 7, 14, 18, 5, 8, 12, 36, 0, 46, 26, 44, 16, 2, 28, 29, 46, 40, 47, 20, 1, 30, 31, 43, 7, 27, 12, 36, 14, 5, 12, 40, 12, 29, 10, 19, 39, 24, 5, 41, 20, 33, 37, 38, 38, 16, 20, 34, 6, 17, 6, 10, 49, 37, 5, 9, 17, 18, 45, 33, 
23, 8, 23, 37, 39, 33, 7, 28, 7, 14, 21, 29, 0, 9, 18, 38, 25, 38, 24, 33, 7, 31, 43, 8, 20, 49, 17, 39, 19, 13, 22, 44, 23, 47, 31, 12, 32, 40, 42, 41, 7, 15, 21, 7, 24, 41, 47, 1, 31, 21, 37, 40, 4, 30, 48, 25, 31, 16, 16, 2, 31, 39, 46, 4, 
38, 30, 18, 21, 20, 12, 12, 29, 27, 35, 36, 4, 26, 33, 7, 9, 7, 44, 49, 11, 27, 0, 36, 10, 18, 5, 13, 49, 44, 11, 5, 34, 41, 25, 5, 14, 39, 18, 43, 18, 5, 32, 22, 32, 17, 30, 43, 24, 26, 43, 36, 3, 43, 24, 14, 13, 29, 27, 12, 25, 38, 19, 10, 32, 
44, 17, 46, 35, 37, 41, 3, 43, 23, 28, 25, 41, 10, 18, 17, 36, 13, 5, 40, 8, 30, 4, 21, 11, 33, 35, 39, 23, 4, 1, 5, 0, 18, 3, 35, 6, 45, 39, 49, 20, 17, 26, 13, 27, 46, 31, 15, 10, 36, 5, 20, 18, 11, 42, 32, 46, 29, 21, 20, 34, 22, 27, 34, 40, 
33, 22, 48, 30, 13, 47, 0, 30, 23, 14, 9, 22, 47, 24, 32, 35, 32, 4, 4, 43, 48, 36, 40, 28, 9, 12, 12, 33, 41, 48, 23, 24, 22, 22, 4, 35, 21, 7, 15, 47, 21, 26, 19, 18, 1, 3, 3, 33, 7, 9, 28, 6, 47, 20, 34, 8, 34, 48, 41, 26, 48, 15, 2, 21, 
39, 9, 6, 10, 16, 24, 9, 39, 0, 28, 9, 3, 31, 14, 38, 39, 26, 17, 47, 23, 37, 31, 32, 22, 31, 25, 0, 29, 40, 4, 0, 31, 13, 7, 44, 31, 31, 3, 20, 33, 32, 31, 37, 15, 46, 25, 4, 22, 42, 1, 47, 32, 34, 31, 6, 15, 7, 8, 45, 49, 12, 47, 33, 26, 
4, 27, 9, 37, 32, 32, 21, 16, 13, 10, 32, 11, 35, 36, 35, 30, 40, 33, 14, 26, 16, 20, 42, 25, 28, 39, 25, 40, 36, 10, 18, 43, 37, 28, 32, 21, 10, 5, 38, 25, 15, 20, 37, 3, 8, 22, 33, 0, 7, 47, 27, 26, 19, 21, 1, 49, 10, 28, 39, 48, 38, 10, 43, 27, 
40, 26, 49, 2, 31, 37, 27, 49, 7, 16, 2, 17, 41, 35, 18, 48, 34, 45, 26, 5, 16, 28, 4, 28, 8, 43, 28, 47, 5, 22, 24, 45, 0, 25, 47, 33, 12, 27, 32, 21, 43, 34, 39, 34, 21, 9, 35, 7, 4, 11, 12, 22, 41, 16, 2, 0, 12, 32, 49, 17, 4, 23, 15, 6, 
1, 14, 40, 13, 41, 22, 37, 37, 9, 28, 21, 30, 37, 6, 40, 41, 20, 2, 15, 11, 19, 17, 11, 33, 1, 12, 0, 6, 38, 17, 14, 39, 32, 4, 4, 25, 29, 41, 12, 38, 19, 36, 20, 6, 44, 10, 49, 14, 15, 14, 26, 36, 33, 39, 19, 35, 2, 21, 43, 40, 39, 9, 31, 23, 
14, 35, 48, 45, 27, 13, 33, 48, 49, 5, 5, 43, 18, 6, 10, 33, 23, 36, 21, 8, 27, 40, 45, 31, 11, 40, 23, 0, 0, 4, 25, 14, 42, 24, 9, 19, 39, 44, 19, 38, 1, 26, 33, 19, 33, 43, 4, 6, 31, 25, 16, 11, 17, 12, 42, 29, 2, 18, 31, 2, 24, 7, 18, 16, 
33, 27, 37, 22, 23, 7, 12, 25, 33, 47, 46, 18, 41, 3, 26, 24, 30, 43, 35, 48, 5, 30, 29, 9, 48, 10, 12, 24, 19, 30, 41, 2, 10, 30, 26, 33, 39, 40, 8, 23, 38, 7, 43, 31, 10, 20, 5, 40, 13, 41, 38, 20, 21, 17, 29, 21, 30, 43, 45, 49, 24, 38, 4, 36, 
19, 32, 19, 10, 23, 30, 33, 13, 37, 29, 44, 49, 49, 1, 39, 14, 42, 30, 36, 15, 49, 15, 36, 31, 11, 34, 33, 37, 22, 37, 23, 43, 19, 42, 4, 44, 24, 39, 9, 13, 18, 3, 12, 19, 5, 4, 33, 49, 34, 19, 15, 35, 37, 3, 19, 0, 37, 2, 37, 12, 39, 10, 5, 10, 
4, 11, 7, 29, 3, 16, 42, 21, 22, 5, 43, 29, 11, 28, 28, 47, 0, 45, 32, 37, 49, 1, 39, 36, 3, 26, 48, 44, 36, 6, 7, 42, 17, 14, 21, 20, 30, 16, 44, 4, 23, 37, 33, 34, 17, 12, 31, 17, 9, 15, 6, 8, 19, 45, 45, 22, 21, 45, 19, 9, 1, 26, 2, 21, 
40, 25, 43, 22, 41, 39, 27, 16, 28, 12, 0, 46, 24, 33, 13, 36, 49, 20, 44, 18, 15, 41, 42, 39, 37, 13, 48, 40, 39, 2, 13, 31, 28, 7, 4, 21, 46, 33, 38, 25, 45, 40, 21, 22, 26, 34, 8, 25, 6, 2, 45, 22, 46, 39, 11, 33, 3, 11, 25, 42, 16, 39, 24, 44, 
46, 30, 17, 44, 13, 7, 19, 10, 0, 42, 32, 26, 29, 40, 3, 35, 45, 48, 7, 41, 37, 20, 26, 40, 34, 1, 33, 0, 42, 9, 46, 40, 39, 13, 35, 4, 23, 6, 14, 23, 1, 49, 1, 30, 39, 4, 15, 36, 2, 25, 29, 41, 47, 7, 34, 31, 11, 19, 31, 3, 28, 27, 44, 19, 
43, 31, 23, 18, 37, 39, 43, 38, 38, 44, 20, 30, 48, 36, 18, 2, 13, 48, 45, 10, 5, 29, 42, 16, 48, 25, 22, 28, 3, 16, 47, 48, 47, 22, 16, 36, 12, 9, 27, 0, 3, 47, 32, 3, 35, 1, 7, 48, 49, 4, 11, 6, 34, 3, 25, 34, 28, 47, 13, 33, 15, 10, 31, 14, 
35, 47, 0, 47, 8, 29, 49, 13, 29, 34, 16, 14, 35, 25, 15, 36, 30, 26, 42, 16, 29, 19, 2, 9, 16, 15, 45, 33, 28, 26, 47, 13, 26, 0, 12, 36, 29, 13, 0, 8, 47, 16, 25, 32, 44, 40, 20, 26, 18, 15, 44, 49, 34, 46, 8, 3, 12, 3, 36, 42, 32, 34, 7, 10, 
34, 19, 46, 15, 34, 46, 24, 32, 15, 1, 16, 11, 43, 37, 37, 11, 2, 31, 10, 38, 29, 20, 41, 43, 24, 28, 35, 8, 12, 42, 20, 46, 13, 16, 11, 0, 15, 37, 34, 32, 40, 0, 43, 33, 39, 30, 44, 43, 13, 4, 32, 44, 25, 23, 38, 1, 1, 23, 11, 15, 18, 31, 13, 33, 
49, 27, 35, 14, 14, 19, 46, 7, 22, 41, 40, 11, 23, 37, 7, 36, 43, 39, 31, 20, 14, 21, 21, 18, 46, 34, 33, 14, 17, 47, 0, 17, 24, 35, 33, 40, 7, 32, 49, 29, 23, 40, 42, 47, 29, 49, 35, 22, 40, 18, 43, 5, 39, 16, 25, 36, 3, 10, 2, 20, 7, 4, 37, 33, 
40, 21, 26, 47, 5, 27, 28, 28, 19, 20, 27, 48, 20, 13, 21, 10, 33, 16, 17, 23, 32, 42, 11, 35, 3, 13, 8, 12, 18, 45, 48, 10, 18, 26, 9, 23, 3, 37, 4, 23, 7, 31, 23, 29, 46, 44, 42, 30, 12, 9, 5, 47, 4, 16, 34, 9, 31, 42, 23, 1, 38, 21, 13, 8, 
49, 22, 34, 5, 11, 40, 30, 21, 23, 3, 0, 20, 0, 42, 2, 12, 4, 7, 9, 8, 25, 44, 17, 8, 36, 40, 10, 26, 14, 23, 37, 15, 48, 21, 20, 9, 13, 0, 32, 36, 4, 33, 8, 6, 27, 10, 18, 31, 19, 28, 41, 46, 24, 8, 5, 10, 1, 15, 39, 17, 40, 26, 32, 38, 
49, 5, 0, 12, 7, 32, 48, 11, 17, 7, 19, 47, 19, 38, 28, 39, 18, 20, 35, 42, 30, 42, 4, 33, 7, 43, 0, 0, 21, 35, 38, 20, 40, 40, 34, 47, 25, 33, 11, 44, 42, 30, 41, 13, 20, 20, 4, 38, 42, 42, 30, 22, 34, 35, 8, 44, 30, 8, 44, 2, 45, 34, 22, 37, 
25, 7, 35, 2, 42, 48, 46, 36, 30, 40, 49, 1, 12, 6, 39, 4, 48, 22, 28, 32, 7, 38, 26, 37, 47, 20, 39, 44, 5, 14, 32, 32, 23, 19, 36, 15, 17, 34, 3, 49, 24, 4, 0, 36, 10, 42, 42, 8, 14, 23, 41, 21, 11, 19, 10, 10, 40, 2, 5, 47, 16, 39, 31, 39, 
8, 17, 6, 25, 1, 11, 24, 28, 15, 27, 16, 26, 19, 11, 34, 33, 36, 27, 6, 49, 47, 16, 10, 39, 20, 17, 36, 36, 8, 17, 27, 16, 36, 35, 43, 37, 46, 19, 17, 12, 46, 34, 40, 17, 45, 24, 0, 31, 2, 8, 30, 1, 25, 42, 40, 47, 11, 26, 34, 19, 45, 13, 35, 31, 
1, 30, 20, 47, 0, 38, 11, 46, 24, 1, 14, 19, 28, 16, 2, 32, 25, 32, 33, 2, 27, 23, 49, 40, 1, 35, 10, 46, 49, 47, 29, 2, 28, 49, 49, 28, 39, 13, 26, 13, 16, 40, 34, 44, 9, 36, 26, 34, 21, 9, 38, 0, 34, 39, 40, 35, 25, 0, 31, 26, 0, 12, 28, 28, 
14, 29, 8, 3, 44, 34, 19, 11, 27, 5, 7, 36, 42, 34, 22, 15, 45, 10, 15, 32, 49, 7, 17, 26, 8, 1, 2, 10, 13, 32, 38, 27, 14, 46, 33, 8, 30, 4, 19, 7, 9, 27, 45, 1, 13, 17, 18, 10, 29, 35, 42, 31, 43, 12, 7, 3, 13, 12, 13, 28, 46, 1, 6, 10, 
49, 41, 19, 31, 45, 40, 39, 4, 19, 36, 8, 32, 4, 26, 45, 33, 14, 37, 14, 7, 1, 24, 10, 14, 38, 23, 43, 34, 26, 1, 45, 25, 44, 16, 6, 39, 6, 47, 45, 26, 34, 3, 10, 40, 32, 5, 23, 48, 45, 40, 5, 46, 16, 17, 13, 4, 40, 8, 40, 18, 11, 35, 43, 5, 
1, 1, 44, 10, 1, 41, 38, 35, 47, 48, 25, 31, 6, 0, 29, 1, 42, 34, 49, 10, 1, 14, 14, 43, 22, 5, 11, 33, 42, 6, 40, 46, 9, 36, 8, 10, 28, 46, 47, 25, 44, 24, 6, 0, 25, 35, 3, 19, 21, 5, 30, 24, 19, 46, 17, 44, 3, 30, 29, 46, 36, 20, 44, 45, 
8, 2, 8, 36, 48, 5, 13, 44, 30, 21, 47, 7, 8, 0, 28, 29, 7, 8, 3, 29, 7, 22, 25, 10, 2, 4, 8, 40, 26, 2, 36, 35, 6, 46, 23, 4, 1, 37, 1, 33, 10, 48, 42, 19, 0, 21, 0, 8, 31, 6, 37, 38, 28, 12, 1, 33, 18, 9, 23, 45, 14, 11, 32, 22, 
7, 7, 29, 11, 44, 30, 44, 7, 28, 37, 26, 28, 10, 28, 36, 41, 34, 25, 32, 15, 39, 33, 48, 8, 44, 23, 5, 10, 35, 39, 33, 44, 46, 12, 5, 43, 42, 0, 0, 20, 39, 28, 0, 49, 6, 37, 42, 41, 14, 24, 8, 4, 9, 8, 14, 4, 31, 19, 16, 18, 10, 49, 13, 6, 
13, 18, 49, 5, 20, 1, 27, 11, 29, 28, 12, 36, 17, 5, 29, 33, 29, 39, 37, 39, 47, 3, 45, 30, 24, 11, 49, 34, 11, 14, 43, 26, 34, 42, 32, 7, 46, 11, 18, 25, 41, 31, 13, 10, 36, 44, 44, 17, 35, 33, 8, 32, 37, 3, 15, 13, 17, 14, 48, 30, 30, 41, 6, 14, 
35, 38, 23, 31, 2, 42, 9, 45, 25, 24, 6, 13, 21, 2, 30, 6, 35, 41, 39, 24, 44, 6, 38, 11, 20, 38, 41, 2, 29, 48, 18, 16, 38, 42, 0, 42, 34, 9, 38, 11, 35, 46, 24, 6, 48, 6, 13, 35, 47, 4, 12, 44, 10, 2, 7, 32, 40, 1, 36, 21, 49, 4, 39, 39, 
46, 39, 34, 32, 0, 22, 43, 36, 18, 19, 42, 18, 26, 7, 3, 25, 13, 15, 19, 25, 19, 27, 9, 9, 30, 45, 32, 31, 0, 22, 20, 46, 13, 6, 29, 14, 28, 24, 0, 48, 44, 44, 18, 22, 4, 22, 47, 17, 39, 19, 43, 9, 48, 4, 20, 28, 0, 5, 9, 0, 29, 31, 48, 42, 
38, 27, 6, 18, 4, 8, 19, 48, 3, 37, 20, 7, 11, 19, 26, 3, 40, 21, 14, 38, 26, 36, 16, 26, 41, 27, 28, 22, 9, 26, 15, 49, 4, 23, 17, 8, 32, 38, 8, 37, 26, 30, 44, 39, 1, 22, 42, 42, 44, 6, 30, 22, 43, 49, 48, 36, 28, 26, 9, 37, 2, 26, 38, 8, 
49, 8, 18, 31, 46, 28, 20, 24, 8, 14, 14, 12, 39, 6, 4, 35, 15, 34, 7, 10, 35, 7, 46, 14, 33, 5, 3, 37, 33, 42, 48, 33, 0, 18, 16, 46, 49, 37, 21, 9, 3, 37, 21, 42, 43, 25, 27, 10, 12, 36, 20, 47, 43, 17, 11, 28, 24, 17, 16, 8, 9, 16, 43, 9, 
36, 9, 7, 35, 46, 30, 45, 2, 17, 16, 46, 13, 42, 24, 23, 6, 10, 44, 3, 6, 13, 17, 34, 39, 34, 2, 49, 43, 18, 42, 4, 5, 4, 13, 42, 2, 44, 37, 4, 11, 6, 1, 26, 48, 27, 0, 4, 39, 46, 9, 45, 11, 26, 30, 2, 12, 32, 2, 7, 3, 46, 11, 10, 0, 
27, 2, 3, 21, 40, 7, 34, 48, 10, 11, 48, 37, 13, 4, 27, 11, 13, 24, 24, 42, 4, 26, 4, 39, 28, 14, 42, 25, 27, 2, 27, 4, 4, 30, 25, 46, 40, 10, 44, 0, 23, 42, 40, 38, 46, 19, 49, 12, 43, 25, 4, 48, 1, 10, 37, 32, 24, 29, 9, 2, 33, 36, 6, 37, 
17, 34, 36, 9, 46, 30, 9, 19, 25, 1, 7, 23, 20, 8, 35, 14, 33, 39, 14, 36, 2, 3, 18, 26, 32, 27, 30, 17, 16, 37, 4, 33, 21, 42, 44, 17, 25, 5, 38, 0, 7, 47, 23, 27, 7, 9, 43, 42, 0, 7, 28, 2, 10, 47, 31, 44, 26, 11, 11, 42, 48, 18, 27, 21, 
10, 21, 40, 37, 29, 30, 37, 36, 29, 13, 13, 36, 24, 9, 28, 24, 16, 9, 29, 27, 8, 10, 21, 34, 23, 35, 29, 24, 3, 8, 45, 15, 32, 38, 3, 11, 18, 42, 47, 0, 5, 12, 36, 31, 21, 17, 8, 38, 26, 37, 17, 34, 49, 40, 20, 22, 27, 1, 46, 32, 10, 44, 48, 42, 
32, 3, 3, 2, 47, 2, 4, 5, 14, 41, 36, 38, 10, 44, 28, 38, 33, 45, 22, 34, 37, 44, 7, 15, 46, 5, 47, 6, 49, 47, 0, 33, 2, 3, 38, 0, 5, 42, 5, 21, 35, 41, 11, 45, 38, 39, 33, 23, 36, 7, 8, 26, 2, 15, 41, 0, 20, 40, 8, 22, 38, 8, 7, 40, 
11, 45, 40, 18, 40, 47, 41, 25, 41, 3, 23, 29, 44, 8, 2, 33, 16, 10, 9, 20, 27, 0, 22, 0, 40, 30, 24, 30, 38, 31, 21, 49, 29, 13, 19, 19, 11, 12, 46, 4, 17, 19, 33, 12, 28, 37, 45, 46, 0, 4, 16, 29, 6, 38, 29, 46, 18, 5, 29, 8, 37, 0, 7, 18, 
15, 28, 37, 28, 40, 35, 32, 8, 5, 17, 22, 35, 7, 19, 31, 7, 23, 49, 36, 29, 39, 18, 27, 7, 23, 6, 15, 12, 8, 24, 30, 26, 4, 19, 6, 46, 5, 39, 6, 12, 8, 28, 47, 15, 47, 30, 22, 22, 29, 11, 3, 18, 31, 33, 27, 6, 41, 44, 19, 2, 20, 1, 28, 26, 
23, 34, 22, 30, 25, 29, 44, 34, 9, 41, 49, 9, 23, 24, 31, 2, 35, 37, 22, 16, 20, 1, 24, 11, 45, 43, 15, 17, 47, 43, 43, 22, 30, 17, 4, 7, 46, 48, 41, 8, 39, 43, 17, 12, 17, 0, 16, 4, 37, 40, 22, 9, 41, 46, 23, 38, 42, 38, 5, 39, 32, 0, 13, 14, 
17, 17, 21, 16, 15, 15, 24, 6, 8, 41, 20, 25, 41, 38, 29, 31, 28, 1, 40, 19, 47, 13, 9, 41, 2, 16, 32, 36, 16, 45, 0, 35, 14, 23, 1, 29, 38, 27, 37, 46, 18, 7, 23, 12, 45, 4, 43, 25, 7, 35, 46, 5, 49, 5, 48, 3, 23, 31, 39, 39, 26, 41, 27, 41, 
14, 30, 22, 5, 8, 10, 1, 26, 19, 27, 40, 15, 31, 33, 42, 39, 19, 39, 46, 20, 46, 44, 23, 20, 25, 14, 11, 4, 5, 38, 45, 21, 19, 19, 26, 27, 29, 30, 5, 49, 7, 46, 16, 38, 31, 8, 29, 2, 49, 25, 24, 46, 22, 47, 16, 47, 11, 27, 1, 18, 16, 48, 40, 37, 
18, 16, 16, 49, 46, 21, 48, 5, 19, 16, 46, 1, 27, 25, 5, 26, 3, 30, 22, 25, 29, 38, 22, 43, 18, 26, 11, 36, 26, 1, 23, 44, 20, 39, 46, 18, 12, 46, 24, 32, 13, 20, 35, 40, 47, 42, 18, 0, 22, 43, 25, 4, 33, 0, 47, 1, 28, 8, 37, 4, 12, 12, 1, 32, 
1, 47, 2, 16, 43, 26, 0, 8, 48, 37, 0, 48, 29, 19, 48, 4, 12, 26, 8, 47, 28, 5, 49, 8, 13, 36, 14, 27, 1, 15, 9, 4, 14, 12, 20, 10, 40, 20, 18, 41, 7, 21, 39, 39, 40, 39, 43, 4, 17, 3, 1, 47, 8, 2, 5, 23, 41, 22, 1, 42, 39, 12, 46, 4, 
26, 19, 16, 19, 39, 34, 10, 49, 5, 1, 40, 47, 42, 33, 3, 12, 38, 7, 11, 46, 11, 19, 21, 2, 41, 24, 46, 30, 37, 43, 36, 15, 12, 2, 34, 3, 39, 46, 4, 46, 47, 44, 46, 42, 29, 49, 6, 17, 8, 17, 15, 22, 36, 37, 24, 27, 11, 21, 8, 0, 16, 46, 16, 30, 
49, 0, 35, 38, 47, 40, 34, 46, 36, 30, 40, 16, 32, 46, 35, 42, 14, 1, 14, 2, 40, 41, 30, 3, 14, 40, 4, 30, 36, 22, 12, 37, 22, 47, 25, 21, 39, 10, 20, 26, 42, 10, 42, 24, 9, 29, 19, 25, 30, 33, 27, 20, 24, 9, 24, 38, 49, 30, 20, 38, 2, 32, 25, 26, 
32, 1, 48, 21, 13, 20, 47, 7, 32, 41, 34, 41, 21, 3, 16, 3, 38, 46, 26, 13, 5, 2, 3, 7, 32, 26, 45, 36, 8, 20, 12, 42, 23, 12, 14, 38, 32, 13, 48, 15, 7, 32, 8, 28, 37, 27, 33, 25, 23, 9, 40, 28, 11, 46, 35, 45, 22, 32, 31, 32, 5, 46, 25, 28, 
8, 39, 19, 43, 4, 17, 10, 11, 1, 20, 41, 38, 47, 25, 13, 20, 36, 6, 1, 48, 2, 38, 45, 24, 23, 29, 6, 28, 25, 31, 8, 35, 22, 29, 30, 27, 46, 40, 40, 47, 13, 32, 37, 10, 7, 1, 33, 43, 7, 36, 43, 9, 26, 39, 35, 49, 18, 41, 27, 45, 23, 38, 30, 47, 
17, 13, 24, 16, 5, 15, 15, 18, 49, 3, 29, 6, 6, 14, 1, 15, 0, 47, 26, 26, 38, 11, 26, 8, 2, 5, 3, 27, 43, 35, 25, 11, 48, 1, 27, 6, 18, 42, 24, 17, 47, 3, 23, 3, 17, 27, 18, 19, 26, 44, 46, 14, 5, 24, 22, 10, 29, 27, 37, 25, 14, 14, 36, 15, 
16, 15, 21, 34, 9, 45, 2, 7, 1, 27, 10, 20, 6, 31, 40, 32, 25, 38, 46, 33, 12, 20, 43, 41, 49, 32, 16, 16, 47, 4, 31, 13, 21, 4, 49, 31, 1, 1, 40, 2, 31, 2, 25, 37, 33, 15, 20, 11, 5, 18, 46, 17, 41, 39, 10, 42, 23, 29, 8, 20, 33, 41, 35, 7, 
47, 37, 40, 49, 38, 30, 3, 21, 34, 28, 9, 20, 45, 31, 33, 0, 1, 29, 19, 42, 20, 30, 37, 43, 9, 47, 16, 44, 39, 3, 3, 38, 40, 43, 37, 31, 25, 41, 2, 12, 21, 13, 32, 17, 44, 15, 19, 46, 44, 39, 40, 14, 21, 27, 9, 30, 25, 25, 26, 16, 31, 30, 4, 21, 
25, 42, 4, 3, 35, 7, 15, 6, 22, 47, 25, 17, 14, 45, 13, 8, 36, 3, 24, 7, 31, 33, 39, 8, 11, 17, 24, 42, 49, 28, 15, 25, 22, 22, 30, 7, 31, 45, 16, 3, 42, 41, 20, 8, 38, 35, 16, 24, 39, 42, 33, 22, 27, 22, 32, 38, 42, 6, 32, 41, 36, 0, 18, 9, 
22, 48, 18, 5, 45, 34, 8, 39, 28, 29, 47, 16, 14, 15, 43, 5, 7, 26, 29, 35, 1, 11, 25, 45, 19, 10, 36, 6, 12, 7, 17, 36, 7, 35, 41, 3, 22, 49, 42, 0, 30, 40, 18, 47, 5, 11, 4, 15, 40, 34, 0, 43, 47, 27, 38, 17, 37, 24, 23, 1, 33, 40, 37, 41};

int m2[N_COL_1][N_COL_2]={27, 28, 46, 1, 30, 38, 3, 10, 30, 22, 9, 36, 35, 14, 3, 27, 0, 5, 20, 47, 32, 8, 14, 22, 35, 37, 23, 18, 29, 11, 11, 9, 39, 7, 10, 19, 46, 16, 32, 28, 38, 41, 16, 25, 7, 19, 3, 7, 24, 25, 5, 7, 34, 19, 31, 19, 9, 4, 39, 40, 15, 1, 1, 7, 
8, 12, 28, 6, 28, 10, 35, 18, 4, 1, 45, 11, 21, 0, 19, 45, 26, 26, 4, 12, 45, 35, 31, 6, 40, 20, 49, 7, 23, 0, 16, 32, 14, 45, 40, 42, 7, 25, 12, 13, 29, 10, 27, 0, 10, 46, 47, 38, 24, 4, 0, 21, 39, 31, 28, 31, 4, 29, 41, 27, 29, 7, 11, 44, 
4, 2, 38, 14, 29, 3, 29, 8, 13, 6, 10, 25, 4, 10, 14, 28, 14, 14, 0, 3, 48, 30, 37, 4, 9, 28, 33, 38, 37, 45, 34, 44, 49, 23, 8, 28, 28, 37, 39, 41, 46, 49, 18, 0, 9, 32, 29, 23, 49, 29, 29, 47, 9, 16, 3, 20, 46, 36, 8, 33, 33, 45, 27, 32, 
20, 37, 13, 48, 27, 2, 41, 23, 3, 9, 25, 13, 42, 4, 38, 43, 35, 19, 42, 46, 37, 45, 16, 33, 31, 27, 19, 15, 22, 48, 49, 42, 38, 12, 40, 15, 14, 31, 40, 20, 42, 15, 33, 36, 22, 23, 29, 7, 45, 21, 4, 32, 18, 22, 18, 2, 49, 39, 19, 21, 39, 18, 15, 27, 
33, 5, 44, 49, 38, 34, 19, 33, 2, 4, 19, 24, 28, 49, 33, 23, 22, 39, 7, 43, 12, 25, 45, 13, 16, 14, 37, 6, 34, 2, 33, 17, 10, 30, 17, 0, 16, 36, 33, 18, 41, 3, 44, 21, 4, 28, 46, 28, 17, 5, 21, 29, 33, 18, 43, 49, 34, 32, 5, 19, 34, 41, 38, 44, 
21, 7, 47, 39, 44, 30, 8, 37, 35, 4, 10, 39, 32, 8, 20, 0, 13, 41, 31, 46, 12, 26, 46, 46, 8, 3, 17, 45, 44, 6, 41, 17, 13, 38, 9, 9, 19, 19, 48, 6, 23, 8, 48, 6, 16, 18, 8, 32, 11, 41, 28, 23, 18, 26, 20, 28, 30, 37, 23, 26, 45, 15, 46, 9, 
3, 5, 20, 24, 24, 19, 33, 47, 27, 31, 5, 46, 49, 13, 28, 10, 7, 8, 36, 25, 35, 8, 3, 15, 47, 29, 41, 43, 44, 37, 4, 49, 44, 24, 26, 18, 45, 9, 18, 25, 42, 23, 21, 41, 39, 1, 3, 46, 9, 41, 23, 44, 49, 28, 11, 47, 9, 3, 40, 3, 42, 46, 5, 39, 
22, 33, 7, 18, 44, 27, 43, 36, 3, 16, 29, 42, 17, 32, 40, 28, 24, 15, 23, 25, 45, 34, 22, 5, 39, 14, 10, 34, 10, 15, 23, 35, 0, 32, 3, 44, 10, 46, 32, 13, 12, 11, 7, 31, 44, 49, 9, 20, 16, 34, 45, 11, 21, 20, 16, 12, 36, 27, 46, 49, 44, 21, 34, 45, 
6, 37, 41, 16, 35, 24, 31, 49, 37, 40, 30, 31, 41, 41, 3, 7, 26, 1, 18, 47, 23, 37, 11, 9, 14, 10, 8, 10, 31, 44, 7, 37, 33, 49, 5, 18, 25, 38, 17, 12, 28, 49, 46, 19, 41, 1, 28, 19, 4, 47, 18, 27, 34, 29, 39, 0, 39, 49, 10, 23, 44, 18, 12, 27, 
19, 20, 46, 46, 8, 15, 10, 39, 17, 6, 10, 8, 10, 39, 29, 14, 38, 47, 42, 24, 28, 31, 24, 18, 30, 36, 43, 26, 6, 5, 4, 27, 27, 2, 25, 36, 19, 36, 27, 36, 44, 37, 44, 4, 26, 23, 19, 16, 22, 13, 40, 1, 46, 16, 21, 28, 5, 14, 5, 11, 21, 11, 41, 49, 
13, 16, 37, 32, 4, 14, 21, 49, 1, 15, 5, 30, 41, 26, 46, 15, 39, 37, 16, 37, 3, 39, 16, 8, 5, 23, 22, 27, 36, 15, 28, 1, 33, 15, 33, 38, 29, 6, 39, 32, 22, 44, 12, 15, 21, 9, 32, 12, 46, 1, 0, 1, 40, 18, 12, 46, 43, 36, 25, 29, 3, 3, 30, 36, 
18, 15, 26, 49, 22, 15, 31, 46, 10, 44, 13, 31, 5, 45, 43, 3, 46, 45, 4, 39, 13, 18, 35, 8, 6, 10, 37, 9, 15, 17, 46, 33, 33, 22, 34, 7, 38, 15, 3, 0, 9, 16, 33, 14, 11, 28, 19, 10, 24, 24, 49, 39, 44, 34, 48, 1, 46, 35, 10, 11, 5, 8, 46, 40, 
31, 30, 47, 21, 47, 0, 23, 9, 18, 6, 25, 31, 34, 45, 41, 10, 19, 40, 0, 15, 26, 0, 16, 24, 35, 27, 37, 42, 37, 33, 32, 18, 15, 29, 41, 13, 31, 14, 22, 49, 20, 49, 31, 7, 44, 22, 17, 15, 15, 17, 31, 43, 17, 47, 18, 5, 26, 5, 47, 14, 41, 32, 34, 6, 
11, 28, 21, 45, 42, 45, 44, 15, 45, 27, 22, 39, 2, 39, 5, 17, 9, 36, 10, 28, 35, 30, 35, 14, 36, 35, 30, 27, 17, 14, 35, 30, 42, 9, 25, 37, 4, 22, 2, 1, 49, 26, 41, 1, 17, 48, 20, 26, 36, 33, 7, 21, 13, 42, 37, 1, 29, 17, 30, 46, 32, 16, 27, 26, 
27, 4, 13, 31, 26, 17, 35, 28, 43, 28, 31, 11, 26, 4, 39, 12, 37, 46, 35, 2, 41, 25, 4, 20, 42, 34, 17, 24, 2, 46, 3, 29, 0, 16, 13, 29, 36, 48, 7, 29, 26, 38, 40, 4, 42, 30, 18, 31, 28, 5, 34, 19, 30, 40, 42, 23, 26, 9, 49, 31, 7, 2, 10, 9, 
21, 25, 38, 7, 23, 45, 38, 1, 36, 31, 5, 30, 13, 23, 12, 41, 29, 48, 13, 9, 40, 5, 32, 16, 16, 34, 47, 23, 36, 10, 34, 9, 35, 23, 18, 11, 20, 7, 12, 8, 38, 18, 39, 1, 43, 3, 44, 24, 1, 9, 34, 43, 14, 18, 9, 32, 2, 9, 7, 41, 19, 42, 2, 6, 
15, 21, 17, 37, 30, 32, 46, 18, 2, 35, 21, 45, 40, 17, 20, 41, 27, 6, 36, 43, 26, 45, 26, 29, 6, 35, 22, 27, 27, 24, 36, 44, 47, 3, 32, 27, 37, 30, 47, 39, 15, 20, 37, 5, 38, 9, 48, 17, 15, 34, 12, 41, 31, 40, 22, 40, 26, 46, 17, 5, 21, 5, 0, 18, 
9, 34, 48, 48, 14, 45, 38, 31, 16, 27, 38, 6, 36, 38, 25, 3, 24, 37, 46, 7, 28, 19, 47, 4, 17, 17, 11, 38, 22, 11, 9, 33, 47, 7, 32, 13, 4, 22, 44, 20, 1, 34, 28, 37, 22, 3, 42, 46, 41, 38, 4, 21, 9, 1, 27, 27, 20, 38, 17, 43, 2, 28, 28, 49, 
35, 10, 15, 42, 34, 9, 14, 35, 46, 43, 24, 18, 48, 16, 15, 41, 7, 21, 12, 18, 24, 41, 45, 45, 30, 15, 40, 32, 43, 18, 33, 31, 31, 48, 23, 17, 10, 39, 3, 6, 32, 27, 24, 31, 46, 41, 24, 3, 14, 37, 23, 39, 28, 21, 36, 10, 36, 26, 42, 31, 46, 28, 14, 29, 
26, 39, 47, 36, 29, 2, 44, 11, 31, 19, 44, 27, 12, 19, 32, 27, 8, 6, 18, 38, 27, 4, 49, 15, 32, 43, 46, 30, 23, 11, 10, 0, 0, 9, 38, 29, 11, 33, 43, 44, 4, 39, 24, 18, 10, 6, 47, 18, 14, 15, 9, 43, 19, 8, 10, 1, 3, 9, 34, 27, 22, 46, 29, 24, 
5, 19, 4, 18, 4, 49, 12, 10, 40, 36, 29, 1, 45, 26, 19, 11, 42, 30, 7, 13, 40, 17, 17, 44, 28, 1, 23, 0, 47, 2, 25, 2, 23, 31, 22, 28, 30, 36, 38, 20, 23, 17, 21, 20, 46, 43, 33, 40, 25, 40, 3, 16, 10, 20, 12, 38, 23, 35, 39, 20, 39, 16, 24, 12, 
47, 46, 40, 27, 35, 31, 49, 10, 0, 23, 30, 46, 18, 15, 36, 43, 6, 42, 11, 18, 14, 23, 8, 38, 8, 49, 8, 49, 15, 35, 14, 12, 33, 4, 41, 18, 37, 43, 28, 38, 16, 10, 34, 36, 26, 23, 31, 34, 15, 43, 2, 29, 16, 10, 17, 27, 12, 28, 26, 27, 13, 40, 40, 48, 
47, 31, 17, 34, 24, 45, 24, 42, 8, 9, 30, 34, 34, 12, 18, 49, 7, 22, 30, 23, 34, 0, 2, 46, 30, 31, 24, 45, 23, 16, 43, 22, 47, 10, 7, 24, 8, 31, 18, 16, 42, 49, 2, 26, 13, 22, 27, 20, 44, 10, 45, 28, 10, 0, 27, 40, 31, 3, 37, 4, 19, 30, 27, 18, 
43, 36, 44, 3, 19, 13, 21, 14, 14, 23, 42, 29, 45, 20, 1, 41, 30, 48, 21, 42, 48, 48, 34, 29, 1, 21, 36, 22, 3, 15, 41, 46, 3, 35, 49, 24, 0, 22, 38, 14, 45, 31, 43, 42, 3, 46, 33, 35, 45, 7, 27, 43, 5, 11, 25, 9, 34, 13, 31, 37, 28, 24, 36, 33, 
10, 37, 7, 10, 10, 46, 27, 7, 29, 22, 2, 34, 19, 37, 19, 14, 44, 48, 7, 2, 11, 32, 11, 45, 45, 44, 34, 25, 19, 20, 8, 29, 8, 18, 41, 20, 14, 18, 27, 45, 41, 29, 29, 12, 17, 0, 26, 11, 48, 33, 15, 9, 18, 26, 4, 15, 23, 40, 43, 42, 11, 3, 23, 19, 
21, 16, 39, 37, 35, 18, 32, 28, 48, 13, 40, 17, 13, 18, 30, 13, 3, 46, 22, 21, 24, 28, 39, 47, 19, 32, 39, 32, 37, 14, 1, 9, 31, 42, 46, 18, 12, 31, 48, 12, 44, 40, 29, 10, 8, 12, 25, 13, 10, 48, 35, 34, 28, 26, 32, 49, 10, 23, 31, 47, 40, 34, 6, 23, 
28, 3, 41, 41, 36, 41, 3, 32, 31, 35, 44, 41, 47, 20, 4, 7, 20, 41, 43, 48, 19, 25, 48, 29, 1, 29, 27, 43, 16, 35, 16, 44, 40, 7, 35, 26, 0, 39, 9, 33, 26, 3, 26, 23, 23, 32, 32, 43, 24, 25, 44, 43, 3, 44, 25, 6, 25, 4, 49, 41, 39, 15, 36, 30, 
24, 21, 8, 24, 12, 19, 9, 38, 23, 35, 13, 48, 17, 45, 44, 43, 23, 40, 37, 28, 34, 14, 34, 9, 18, 35, 1, 7, 2, 37, 39, 26, 10, 48, 2, 23, 19, 11, 11, 42, 48, 25, 43, 15, 22, 39, 9, 47, 29, 48, 25, 15, 12, 11, 24, 32, 46, 27, 39, 48, 16, 31, 26, 27, 
31, 30, 0, 0, 43, 13, 45, 41, 40, 40, 9, 15, 29, 18, 12, 10, 18, 40, 25, 30, 1, 1, 12, 48, 31, 3, 48, 47, 36, 27, 24, 17, 7, 26, 20, 1, 42, 15, 44, 32, 5, 3, 49, 36, 23, 12, 48, 41, 2, 25, 23, 5, 28, 37, 3, 9, 41, 4, 7, 27, 31, 33, 47, 40, 
10, 17, 43, 2, 34, 40, 36, 41, 43, 36, 27, 17, 0, 25, 10, 4, 2, 34, 9, 30, 21, 15, 40, 14, 21, 49, 44, 4, 32, 41, 44, 42, 10, 40, 46, 44, 30, 35, 35, 25, 23, 14, 42, 23, 41, 5, 27, 43, 39, 38, 23, 10, 3, 15, 27, 26, 14, 21, 30, 47, 12, 25, 41, 22, 
17, 40, 18, 47, 25, 3, 22, 48, 19, 17, 23, 10, 22, 2, 5, 13, 40, 28, 25, 46, 46, 2, 22, 10, 23, 3, 7, 37, 30, 1, 11, 47, 41, 29, 46, 16, 34, 20, 16, 3, 39, 39, 15, 13, 41, 20, 26, 31, 1, 4, 29, 47, 6, 2, 7, 32, 7, 17, 19, 39, 18, 31, 36, 9, 
10, 34, 27, 47, 4, 43, 0, 44, 32, 18, 7, 23, 38, 36, 6, 41, 40, 36, 38, 46, 40, 48, 28, 47, 15, 0, 38, 33, 31, 26, 44, 43, 10, 21, 40, 16, 14, 43, 10, 48, 11, 20, 21, 1, 8, 29, 43, 48, 15, 31, 46, 7, 29, 27, 6, 46, 27, 44, 31, 10, 20, 25, 3, 30, 
48, 44, 49, 14, 39, 11, 12, 0, 31, 35, 3, 39, 15, 46, 39, 32, 30, 36, 42, 11, 13, 48, 8, 42, 43, 41, 2, 15, 17, 5, 48, 17, 1, 47, 34, 40, 8, 46, 42, 42, 34, 46, 33, 1, 44, 23, 35, 24, 9, 27, 36, 24, 26, 46, 16, 21, 39, 18, 36, 8, 23, 36, 26, 27, 
33, 10, 17, 44, 8, 12, 36, 42, 8, 19, 45, 2, 42, 31, 29, 3, 8, 17, 27, 36, 15, 45, 7, 4, 13, 46, 13, 39, 32, 39, 16, 18, 1, 35, 12, 9, 49, 0, 4, 7, 19, 49, 12, 14, 30, 41, 19, 41, 10, 49, 27, 25, 44, 37, 29, 10, 35, 42, 49, 19, 33, 17, 37, 34, 
4, 1, 46, 4, 1, 0, 13, 23, 1, 25, 37, 34, 18, 6, 25, 28, 5, 4, 3, 2, 41, 35, 12, 26, 27, 11, 48, 13, 30, 35, 47, 36, 39, 45, 40, 40, 45, 6, 13, 47, 33, 2, 31, 2, 9, 8, 32, 16, 12, 38, 18, 4, 23, 30, 32, 2, 43, 32, 15, 25, 18, 15, 14, 7, 
10, 6, 49, 6, 12, 15, 5, 46, 17, 38, 0, 26, 46, 32, 45, 10, 20, 15, 16, 43, 48, 1, 46, 43, 33, 11, 21, 1, 28, 35, 10, 39, 41, 12, 47, 4, 27, 2, 0, 44, 42, 0, 23, 40, 34, 20, 0, 5, 35, 17, 0, 33, 18, 46, 29, 1, 10, 0, 5, 38, 35, 17, 29, 26, 
29, 26, 32, 8, 28, 34, 3, 22, 36, 28, 12, 21, 48, 13, 26, 35, 30, 28, 21, 48, 25, 0, 1, 37, 0, 6, 27, 37, 26, 7, 15, 5, 33, 48, 16, 14, 32, 19, 36, 19, 49, 49, 42, 49, 12, 20, 34, 44, 48, 5, 44, 25, 7, 45, 12, 7, 4, 42, 46, 30, 49, 12, 37, 34, 
10, 3, 48, 44, 24, 37, 15, 23, 38, 7, 22, 2, 27, 9, 46, 26, 14, 42, 1, 24, 37, 16, 33, 43, 8, 30, 23, 9, 42, 13, 43, 4, 16, 44, 48, 41, 31, 16, 16, 19, 23, 41, 23, 3, 0, 19, 31, 16, 13, 34, 40, 0, 0, 24, 46, 10, 4, 21, 19, 48, 34, 15, 2, 1, 
9, 2, 44, 42, 18, 10, 13, 44, 3, 36, 47, 3, 7, 28, 20, 20, 12, 12, 22, 15, 36, 18, 25, 42, 42, 47, 40, 26, 12, 44, 29, 23, 47, 25, 17, 17, 38, 30, 11, 41, 18, 10, 45, 25, 40, 17, 47, 3, 29, 19, 20, 16, 40, 47, 8, 32, 46, 1, 10, 10, 45, 40, 33, 44, 
17, 0, 12, 5, 32, 25, 47, 0, 36, 44, 27, 26, 11, 24, 31, 40, 44, 3, 8, 36, 1, 19, 18, 49, 20, 28, 10, 15, 20, 45, 10, 38, 46, 22, 45, 30, 49, 42, 31, 37, 38, 10, 16, 49, 35, 47, 42, 31, 3, 2, 17, 6, 21, 37, 5, 41, 15, 15, 7, 38, 11, 17, 28, 9, 
41, 23, 39, 42, 18, 22, 30, 6, 35, 46, 8, 20, 45, 2, 1, 48, 4, 20, 4, 26, 7, 12, 17, 22, 27, 26, 12, 40, 45, 40, 1, 38, 16, 43, 31, 34, 15, 11, 42, 0, 7, 2, 22, 4, 4, 25, 3, 9, 45, 9, 37, 2, 21, 4, 27, 1, 33, 41, 43, 28, 32, 45, 17, 0, 
38, 48, 34, 5, 11, 28, 8, 20, 31, 30, 24, 37, 6, 29, 46, 3, 39, 35, 8, 12, 40, 35, 15, 25, 26, 9, 3, 10, 4, 22, 10, 42, 20, 46, 47, 33, 27, 5, 3, 8, 38, 28, 45, 46, 9, 44, 49, 48, 29, 7, 13, 21, 44, 28, 46, 23, 39, 2, 33, 43, 24, 46, 37, 47, 
44, 37, 30, 21, 44, 34, 29, 32, 14, 27, 28, 23, 23, 30, 24, 4, 39, 37, 26, 34, 17, 24, 7, 7, 26, 42, 2, 3, 40, 40, 0, 35, 27, 30, 6, 21, 16, 38, 6, 30, 17, 36, 6, 40, 18, 30, 44, 8, 19, 22, 44, 38, 47, 3, 45, 25, 47, 0, 28, 38, 42, 30, 23, 19, 
13, 31, 42, 29, 19, 0, 10, 36, 39, 16, 28, 7, 48, 23, 15, 17, 47, 11, 5, 46, 14, 3, 22, 12, 5, 2, 0, 47, 35, 25, 18, 48, 6, 12, 27, 28, 13, 39, 16, 2, 7, 45, 11, 5, 20, 27, 24, 17, 40, 32, 14, 5, 37, 38, 17, 42, 42, 19, 41, 27, 46, 9, 25, 2, 
23, 5, 32, 36, 44, 49, 40, 4, 44, 2, 9, 14, 31, 36, 33, 21, 20, 47, 28, 7, 37, 47, 1, 30, 18, 44, 7, 14, 3, 35, 19, 26, 40, 1, 15, 36, 2, 7, 40, 46, 11, 2, 12, 44, 38, 46, 18, 10, 45, 46, 19, 33, 46, 20, 15, 14, 16, 22, 29, 19, 9, 48, 47, 1, 
1, 14, 38, 4, 22, 28, 2, 35, 32, 15, 30, 22, 13, 48, 32, 10, 46, 1, 45, 42, 23, 10, 7, 39, 35, 36, 10, 44, 36, 10, 46, 39, 24, 36, 43, 48, 16, 48, 34, 49, 13, 16, 21, 28, 14, 6, 38, 10, 7, 34, 5, 33, 44, 12, 22, 31, 0, 35, 26, 38, 45, 24, 27, 21, 
10, 23, 20, 26, 23, 6, 25, 36, 22, 49, 16, 38, 5, 6, 0, 14, 42, 5, 47, 39, 19, 22, 20, 21, 7, 46, 9, 4, 20, 39, 25, 32, 14, 47, 9, 37, 5, 34, 25, 29, 33, 43, 17, 40, 49, 20, 5, 42, 25, 2, 33, 47, 26, 3, 18, 33, 2, 30, 39, 24, 19, 17, 7, 35, 
14, 16, 22, 22, 2, 49, 1, 38, 42, 21, 28, 41, 41, 35, 35, 18, 38, 18, 15, 14, 22, 36, 0, 26, 16, 41, 0, 37, 8, 7, 22, 25, 25, 44, 47, 28, 43, 0, 16, 35, 21, 46, 28, 12, 32, 14, 31, 22, 34, 48, 38, 8, 34, 40, 34, 2, 32, 35, 39, 42, 44, 11, 17, 20, 
7, 16, 48, 2, 17, 16, 39, 40, 14, 18, 3, 46, 34, 36, 20, 18, 36, 9, 27, 23, 1, 13, 25, 33, 48, 15, 26, 43, 26, 45, 13, 34, 14, 13, 38, 31, 29, 28, 21, 45, 46, 26, 44, 30, 14, 14, 0, 3, 25, 29, 26, 27, 43, 3, 12, 43, 18, 40, 36, 47, 36, 1, 33, 0, 
14, 21, 33, 45, 49, 6, 43, 45, 35, 37, 27, 1, 1, 30, 4, 29, 11, 32, 8, 4, 36, 20, 0, 4, 11, 36, 3, 49, 40, 36, 1, 6, 8, 36, 4, 9, 44, 47, 7, 29, 34, 36, 33, 37, 16, 39, 18, 28, 22, 26, 34, 8, 47, 34, 14, 10, 23, 20, 11, 15, 6, 14, 21, 16, 
2, 27, 26, 46, 26, 35, 28, 12, 21, 11, 0, 40, 2, 20, 20, 24, 47, 4, 34, 46, 41, 1, 6, 16, 21, 19, 31, 29, 33, 4, 46, 35, 32, 24, 33, 8, 9, 11, 21, 32, 24, 23, 22, 27, 43, 42, 3, 42, 47, 38, 38, 40, 41, 44, 6, 12, 15, 39, 41, 48, 43, 39, 35, 27, 
15, 19, 36, 26, 32, 9, 9, 7, 34, 31, 36, 27, 26, 39, 22, 25, 27, 10, 15, 18, 7, 23, 32, 22, 12, 26, 23, 7, 17, 8, 35, 33, 29, 23, 11, 14, 32, 20, 21, 16, 4, 9, 45, 30, 48, 17, 5, 28, 28, 22, 48, 37, 45, 31, 9, 9, 9, 34, 16, 26, 45, 1, 9, 24, 
24, 21, 38, 6, 43, 11, 24, 49, 20, 22, 29, 21, 41, 36, 49, 21, 8, 47, 8, 5, 30, 18, 14, 39, 2, 31, 16, 47, 32, 27, 24, 9, 0, 14, 17, 46, 28, 42, 45, 0, 16, 25, 21, 7, 13, 22, 29, 24, 20, 37, 29, 2, 7, 46, 42, 12, 27, 8, 9, 11, 37, 35, 20, 38, 
2, 40, 34, 30, 32, 29, 30, 0, 6, 4, 7, 22, 26, 36, 46, 48, 24, 27, 1, 31, 23, 45, 43, 0, 5, 5, 14, 42, 42, 36, 32, 44, 26, 18, 24, 10, 0, 7, 10, 6, 11, 18, 30, 39, 6, 26, 38, 30, 4, 41, 14, 27, 38, 9, 30, 43, 16, 46, 35, 9, 32, 20, 3, 11, 
38, 30, 21, 38, 39, 34, 47, 0, 4, 27, 41, 10, 4, 31, 41, 10, 24, 7, 39, 12, 16, 19, 5, 35, 15, 43, 44, 0, 13, 49, 11, 3, 31, 32, 42, 20, 18, 41, 22, 22, 18, 16, 33, 24, 47, 26, 36, 22, 33, 26, 34, 1, 45, 42, 36, 13, 37, 32, 13, 0, 34, 24, 5, 17, 
8, 49, 38, 27, 40, 12, 1, 9, 28, 34, 35, 28, 10, 22, 0, 45, 48, 36, 47, 45, 30, 35, 8, 17, 20, 23, 19, 6, 47, 25, 23, 8, 24, 13, 37, 15, 26, 38, 26, 6, 23, 13, 34, 35, 35, 36, 31, 35, 25, 30, 31, 5, 17, 41, 23, 37, 15, 44, 45, 12, 19, 19, 22, 46, 
32, 9, 13, 10, 48, 39, 17, 23, 2, 3, 8, 40, 40, 39, 25, 17, 19, 6, 22, 37, 48, 47, 26, 15, 44, 22, 27, 13, 43, 2, 11, 25, 11, 24, 38, 11, 13, 7, 34, 18, 12, 43, 10, 4, 34, 35, 21, 6, 44, 46, 43, 44, 43, 21, 9, 39, 45, 38, 3, 38, 40, 14, 16, 4, 
41, 4, 15, 4, 13, 0, 24, 25, 45, 34, 30, 29, 22, 1, 35, 16, 47, 30, 12, 43, 4, 21, 32, 49, 11, 37, 38, 2, 4, 6, 8, 45, 12, 23, 1, 25, 25, 28, 2, 20, 14, 32, 0, 36, 36, 37, 4, 35, 18, 16, 30, 22, 39, 15, 23, 1, 4, 13, 5, 8, 19, 13, 5, 31, 
38, 9, 8, 14, 39, 13, 34, 3, 45, 36, 40, 33, 24, 46, 21, 44, 13, 1, 18, 4, 18, 43, 5, 23, 7, 12, 33, 28, 27, 41, 12, 16, 0, 20, 30, 39, 33, 16, 44, 31, 5, 34, 16, 29, 31, 37, 25, 46, 41, 45, 0, 9, 38, 8, 32, 45, 22, 16, 24, 0, 7, 36, 18, 9, 
8, 0, 0, 44, 16, 44, 27, 23, 31, 43, 2, 14, 31, 29, 12, 22, 24, 12, 31, 13, 22, 16, 8, 45, 34, 34, 47, 43, 22, 15, 2, 31, 15, 4, 27, 33, 48, 4, 7, 31, 47, 11, 45, 30, 41, 9, 4, 17, 22, 38, 30, 46, 4, 41, 43, 40, 27, 40, 33, 0, 5, 37, 33, 22, 
41, 10, 8, 41, 16, 17, 25, 15, 30, 22, 46, 23, 32, 0, 41, 6, 40, 23, 2, 46, 14, 46, 36, 44, 36, 19, 44, 44, 6, 29, 18, 49, 39, 28, 43, 5, 45, 18, 20, 28, 42, 18, 1, 24, 21, 42, 30, 11, 18, 33, 8, 34, 31, 44, 28, 17, 16, 22, 13, 24, 3, 34, 26, 42, 
12, 21, 49, 10, 41, 22, 38, 33, 42, 39, 8, 13, 34, 38, 27, 4, 23, 37, 38, 4, 33, 17, 24, 1, 41, 39, 26, 45, 23, 4, 39, 36, 25, 41, 46, 16, 13, 36, 49, 7, 27, 7, 23, 11, 48, 0, 15, 21, 39, 6, 28, 22, 23, 4, 26, 16, 43, 2, 11, 17, 6, 3, 3, 31, 
44, 1, 47, 9, 39, 48, 16, 16, 6, 39, 30, 6, 41, 47, 29, 32, 3, 7, 7, 28, 11, 33, 45, 5, 37, 8, 24, 43, 11, 29, 26, 5, 30, 25, 16, 21, 23, 33, 37, 31, 24, 19, 37, 18, 17, 17, 2, 22, 24, 9, 1, 38, 42, 48, 45, 29, 6, 19, 24, 18, 48, 2, 25, 30, 
27, 42, 1, 1, 27, 40, 34, 3, 10, 22, 23, 29, 39, 26, 1, 15, 35, 4, 5, 30, 2, 0, 11, 9, 19, 38, 29, 17, 40, 6, 49, 18, 0, 0, 21, 27, 41, 5, 33, 3, 29, 6, 32, 20, 32, 33, 38, 20, 38, 43, 2, 42, 46, 13, 1, 17, 1, 32, 35, 44, 39, 36, 12, 39};

int zero=0;


//  ███████╗███████╗████████╗
//  ██╔════╝██╔════╝╚══██╔══╝
//  █████╗  █████╗     ██║   
//  ██╔══╝  ██╔══╝     ██║   
//  ██║     ██║        ██║   
//  ╚═╝     ╚═╝        ╚═╝   

#ifndef local_result
  #define local_result 1
#endif

#define NINPUTS 256

short buf[2*NINPUTS];

#if accl_test == 1
//short dataR1[NINPUTS] = {
int dataR[NINPUTS] = {
  /* inputs for test 1 */
  2, -4, -3, -8, -10, -11, -23, 11, 32, 10, 11, 8, 3, 3, -7, -5, 1, -4, -4, -4,
  -9, -5, -4, -8, -5, -2, 0, 0, -6, -7, -2, 3, 3, 8, 15, 10, 6, 6, 1, 4, -1, 
  -10, -4, -2, -9, -5, -7, -8, -2, -5, -6, -2, -3, 1, -3, -8, -6, 0, 5, 4, 15,
  17, 6, 5, 2, 0, 2, -3, -5, 0, -5, -5, -4, -9, -6, -2, -4, -4, -3, -1, 1, -5,
  -7, -4, 3, 5, 6, 20, 16, 8, 7, 3, 7, 4, -5, -4, -3, -8, -6, -7, -7, -1, -2, 
  -2, -2, -3, 1, 1, -5, -4, 2, 6, 7, 13, 17, 8, 7, 6, 2, 7, 4, 0, -3, -6, -2, 
  -3, -7, -7, -4, -5, -4, -2, 1, 4, -2, -4, -1, 3, 5, 5, 18, 19, 9, 7, 2, 4, 2,
  -6, -5, 0, -1, -2, -5, -8, -2, -4, -7, -5, -4, 1, 0, -5, -4, 1, 3, 3, 7, 15,
  11, 6, 5, 2, 6, 3, -5, -4, -4, -7, -6, -9, -8, -3, -4, -5, -5, -4, 1, -3, -7,
  -5, 0, 4, 3, 12, 15, 7, 5, 4, 1, 1, -5, -7, -1, -2, -5, -4, -8, -7, -3, -6, 
  -6, -5, -3, 0, -5, -6, -3, 1, 2, 3, 13, 14, 9, 6, 3, 4, 3, -4, -6, -3, -5,
  -5, -6, -9, -5, -3, -5, -5, -3, 0, 0, -5, -3, 1, 3, 3, 9, 16, 10, 6, 6, 6, 8,
  2, -2, -2,
};

//short dataI1[NINPUTS] = {
int dataI[NINPUTS] = {
  /* inputs for test 1 */
  1, -1, -1, -2, -2, -2, -3, -1, 0, 0, 1, 2, 2, 3, 3, 2, 2, 2, 2, 1, 0, 0, -1,
  -1, -2, -2, -2, -3, -3, -3, -3, -2, -2, -1, 0, 1, 1, 2, 3, 3, 3, 3, 2, 2, 1,
  1, 0, 0, -1, -1, -2, -2, -2, -2, -3, -3, -3, -2, -2, -1, 0, 1, 1, 2, 3, 3, 4,
  3, 3, 3, 2, 2, 1, 1, 0, 0, -1, -1, -2, -2, -3, -3, -3, -3, -2, -2, -1, 0, 1,
  2, 3, 3, 4, 4, 4, 3, 3, 2, 2, 1, 0, 0, -1, -1, -2, -2, -2, -3, -3, -3, -3,
  -2, -2, -1, 0, 1, 2, 2, 3, 3, 4, 3, 3, 3, 2, 2, 1, 0, -1, -1, -2, -2, -3, -3,
  -4, -3, -4, -3, -2, -2, 0, 1, 1, 2, 2, 3, 3, 3, 2, 2, 2, 2, 1, 0, 0, -1, -2,
  -2, -3, -3, -3, -4, -4, -3, -3, -2, -1, 0, 0, 1, 2, 2, 3, 3, 3, 3, 2, 2, 1,
  1, 0, 0, -1, -1, -2, -2, -2, -3, -3, -3, -3, -2, -2, -1, 0, 1, 2, 2, 3, 3, 3,
  2, 2, 2, 2, 1, 0, 0, 0, -1, -1, -2, -2, -3, -3, -3, -3, -3, -2, -2, 0, 1, 1,
  2, 3, 3, 4, 4, 3, 3, 3, 2, 1, 1, 0, 0, -1, -2, -2, -2, -3, -3, -3, -3, -2, 
  -2, -1, 0, 1, 2, 2, 3, 4, 4, 4, 3,
};
#endif

#if accl_test == 0
short dataR1[NINPUTS] = {
  /* inputs for test 1 */
  2, -4, -3, -8, -10, -11, -23, 11, 32, 10, 11, 8, 3, 3, -7, -5, 1, -4, -4, -4,
  -9, -5, -4, -8, -5, -2, 0, 0, -6, -7, -2, 3, 3, 8, 15, 10, 6, 6, 1, 4, -1, 
  -10, -4, -2, -9, -5, -7, -8, -2, -5, -6, -2, -3, 1, -3, -8, -6, 0, 5, 4, 15,
  17, 6, 5, 2, 0, 2, -3, -5, 0, -5, -5, -4, -9, -6, -2, -4, -4, -3, -1, 1, -5,
  -7, -4, 3, 5, 6, 20, 16, 8, 7, 3, 7, 4, -5, -4, -3, -8, -6, -7, -7, -1, -2, 
  -2, -2, -3, 1, 1, -5, -4, 2, 6, 7, 13, 17, 8, 7, 6, 2, 7, 4, 0, -3, -6, -2, 
  -3, -7, -7, -4, -5, -4, -2, 1, 4, -2, -4, -1, 3, 5, 5, 18, 19, 9, 7, 2, 4, 2,
  -6, -5, 0, -1, -2, -5, -8, -2, -4, -7, -5, -4, 1, 0, -5, -4, 1, 3, 3, 7, 15,
  11, 6, 5, 2, 6, 3, -5, -4, -4, -7, -6, -9, -8, -3, -4, -5, -5, -4, 1, -3, -7,
  -5, 0, 4, 3, 12, 15, 7, 5, 4, 1, 1, -5, -7, -1, -2, -5, -4, -8, -7, -3, -6, 
  -6, -5, -3, 0, -5, -6, -3, 1, 2, 3, 13, 14, 9, 6, 3, 4, 3, -4, -6, -3, -5,
  -5, -6, -9, -5, -3, -5, -5, -3, 0, 0, -5, -3, 1, 3, 3, 9, 16, 10, 6, 6, 6, 8,
  2, -2, -2,
};

short dataI1[NINPUTS] = {
  /* inputs for test 1 */
  1, -1, -1, -2, -2, -2, -3, -1, 0, 0, 1, 2, 2, 3, 3, 2, 2, 2, 2, 1, 0, 0, -1,
  -1, -2, -2, -2, -3, -3, -3, -3, -2, -2, -1, 0, 1, 1, 2, 3, 3, 3, 3, 2, 2, 1,
  1, 0, 0, -1, -1, -2, -2, -2, -2, -3, -3, -3, -2, -2, -1, 0, 1, 1, 2, 3, 3, 4,
  3, 3, 3, 2, 2, 1, 1, 0, 0, -1, -1, -2, -2, -3, -3, -3, -3, -2, -2, -1, 0, 1,
  2, 3, 3, 4, 4, 4, 3, 3, 2, 2, 1, 0, 0, -1, -1, -2, -2, -2, -3, -3, -3, -3,
  -2, -2, -1, 0, 1, 2, 2, 3, 3, 4, 3, 3, 3, 2, 2, 1, 0, -1, -1, -2, -2, -3, -3,
  -4, -3, -4, -3, -2, -2, 0, 1, 1, 2, 2, 3, 3, 3, 2, 2, 2, 2, 1, 0, 0, -1, -2,
  -2, -3, -3, -3, -4, -4, -3, -3, -2, -1, 0, 0, 1, 2, 2, 3, 3, 3, 3, 2, 2, 1,
  1, 0, 0, -1, -1, -2, -2, -2, -3, -3, -3, -3, -2, -2, -1, 0, 1, 2, 2, 3, 3, 3,
  2, 2, 2, 2, 1, 0, 0, 0, -1, -1, -2, -2, -3, -3, -3, -3, -3, -2, -2, 0, 1, 1,
  2, 3, 3, 4, 4, 3, 3, 3, 2, 1, 1, 0, 0, -1, -2, -2, -2, -3, -3, -3, -3, -2, 
  -2, -1, 0, 1, 2, 2, 3, 4, 4, 4, 3,
};
#endif

#if accl_test == 1
static int wprBase128_mem[] = {
  32767,  32758,  32729,  32679,  32610,  32522,  32413,  32286,
  32138,  31972,  31786,  31581,  31357,  31114,  30853,  30572,
  30274,  29957,  29622,  29269,  28899,  28511,  28106,  27684,
  27246,  26791,  26320,  25833,  25330,  24812,  24279,  23732,
  23170,  22595,  22006,  21403,  20788,  20160,  19520,  18868,
  18205,  17531,  16846,  16151,  15447,  14733,  14010,  13279,
  12540,  11793,  11039,  10279,   9512,   8740,   7962,   7180,
   6393,   5602,   4808,   4011,   3212,   2411,   1608,    804,
      0,   -804,  -1608,  -2411,  -3212,  -4011,  -4808,  -5602,
  -6393,  -7180,  -7962,  -8740,  -9512, -10279, -11039, -11793,
 -12540, -13279, -14010, -14733, -15447, -16151, -16846, -17531,
 -18205, -18868, -19520, -20160, -20788, -21403, -22006, -22595,
 -23170, -23732, -24279, -24812, -25330, -25833, -26320, -26791,
 -27246, -27684, -28106, -28511, -28899, -29269, -29622, -29957,
 -30274, -30572, -30853, -31114, -31357, -31581, -31786, -31972,
 -32138, -32286, -32413, -32522, -32610, -32679, -32729, -32758,
};

static int wprBase64_mem[] = {
  32767,  32729,  32610,  32413,
  32138,  31786,  31357,  30853,
  30274,  29622,  28899,  28106,
  27246,  26320,  25330,  24279,
  23170,  22006,  20788,  19520,
  18205,  16846,  15447,  14010,
  12540,  11039,   9512,   7962,
   6393,   4808,   3212,   1608,
      0,  -1608,  -3212,  -4808,
  -6393,  -7962,  -9512, -11039,
 -12540, -14010, -15447, -16846,
 -18205, -19520, -20788, -22006,
 -23170, -24279, -25330, -26320,
 -27246, -28106, -28899, -29622,
 -30274, -30853, -31357, -31786,
 -32138, -32413, -32610, -32729,
};

static int wprBase32_mem[] = {
  32767,  32610,
  32138,  31357,
  30274,  28899,
  27246,  25330,
  23170,  20788,
  18205,  15447,
  12540,   9512,
   6393,   3212,
      0,  -3212,
  -6393,  -9512,
 -12540, -15447,
 -18205, -20788,
 -23170, -25330,
 -27246, -28899,
 -30274, -31357,
 -32138, -32610,
};

static int wprBase16_mem[] = {
  32767,32138,30274,27246,23170,18205,12540,6393,0,-6393,-12540,-18205,-23170,-27246,-30274,-32138,
};

static int wprBase8_mem[] = {
  32767,30274,23170,12540,0,-12540,-23170,-30274,
};

static int wprBase4_mem[] = {
  32767,23170,0,-23170,
};

static int wprBase2_mem[] = {
  32767,0,
};

static int wpiBase128_mem[] = {
      0,    804,   1608,   2411,   3212,   4011,   4808,   5602,
   6393,   7180,   7962,   8740,   9512,  10279,  11039,  11793,
  12540,  13279,  14010,  14733,  15447,  16151,  16846,  17531,
  18205,  18868,  19520,  20160,  20788,  21403,  22006,  22595,
  23170,  23732,  24279,  24812,  25330,  25833,  26320,  26791,
  27246,  27684,  28106,  28511,  28899,  29269,  29622,  29957,
  30274,  30572,  30853,  31114,  31357,  31581,  31786,  31972,
  32138,  32286,  32413,  32522,  32610,  32679,  32729,  32758,
  32767,  32758,  32729,  32679,  32610,  32522,  32413,  32286,
  32138,  31972,  31786,  31581,  31357,  31114,  30853,  30572,
  30274,  29957,  29622,  29269,  28899,  28511,  28106,  27684,
  27246,  26791,  26320,  25833,  25330,  24812,  24279,  23732,
  23170,  22595,  22006,  21403,  20788,  20160,  19520,  18868,
  18205,  17531,  16846,  16151,  15447,  14733,  14010,  13279,
  12540,  11793,  11039,  10279,   9512,   8740,   7962,   7180,
   6393,   5602,   4808,   4011,   3212,   2411,   1608,    804,
};

///*
static int wpiBase64_mem[] = {
      0,   1608,   3212,   4808,
   6393,   7962,   9512,  11039,
  12540,  14010,  15447,  16846,
  18205,  19520,  20788,  22006,
  23170,  24279,  25330,  26320,
  27246,  28106,  28899,  29622,
  30274,  30853,  31357,  31786,
  32138,  32413,  32610,  32729,
  32767,  32729,  32610,  32413,
  32138,  31786,  31357,  30853,
  30274,  29622,  28899,  28106,
  27246,  26320,  25330,  24279,
  23170,  22006,  20788,  19520,
  18205,  16846,  15447,  14010,
  12540,  11039,   9512,   7962,
   6393,   4808,   3212,   1608,
};

static int wpiBase32_mem[] = {
      0,   3212,
   6393,   9512,
  12540,  15447,
  18205,  20788,
  23170,  25330,
  27246,  28899,
  30274,  31357,
  32138,  32610,
  32767,  32610,
  32138,  31357,
  30274,  28899,
  27246,  25330,
  23170,  20788,
  18205,  15447,
  12540,   9512,
   6393,   3212,
};

static int wpiBase16_mem[] = {
 0, 6393,12540,18205,23170,27246,30274,32138,32767,32138,30274,27246,23170,18205,12540, 6393,
};

static int wpiBase8_mem[] = {
 0,12540,23170,30274,32767,30274,23170,12540,
};

static int wpiBase4_mem[] = {
 0,23170,32767,23170,
};

static int wpiBase2_mem[] = {
 0,32767,
};
#endif

#if accl_test == 0
static short wprBase[] = {
  32767,  32758,  32729,  32679,  32610,  32522,  32413,  32286,
  32138,  31972,  31786,  31581,  31357,  31114,  30853,  30572,
  30274,  29957,  29622,  29269,  28899,  28511,  28106,  27684,
  27246,  26791,  26320,  25833,  25330,  24812,  24279,  23732,
  23170,  22595,  22006,  21403,  20788,  20160,  19520,  18868,
  18205,  17531,  16846,  16151,  15447,  14733,  14010,  13279,
  12540,  11793,  11039,  10279,   9512,   8740,   7962,   7180,
   6393,   5602,   4808,   4011,   3212,   2411,   1608,    804,
      0,   -804,  -1608,  -2411,  -3212,  -4011,  -4808,  -5602,
  -6393,  -7180,  -7962,  -8740,  -9512, -10279, -11039, -11793,
 -12540, -13279, -14010, -14733, -15447, -16151, -16846, -17531,
 -18205, -18868, -19520, -20160, -20788, -21403, -22006, -22595,
 -23170, -23732, -24279, -24812, -25330, -25833, -26320, -26791,
 -27246, -27684, -28106, -28511, -28899, -29269, -29622, -29957,
 -30274, -30572, -30853, -31114, -31357, -31581, -31786, -31972,
 -32138, -32286, -32413, -32522, -32610, -32679, -32729, -32758,
};

static short wpiBase[] = {
      0,    804,   1608,   2411,   3212,   4011,   4808,   5602,
   6393,   7180,   7962,   8740,   9512,  10279,  11039,  11793,
  12540,  13279,  14010,  14733,  15447,  16151,  16846,  17531,
  18205,  18868,  19520,  20160,  20788,  21403,  22006,  22595,
  23170,  23732,  24279,  24812,  25330,  25833,  26320,  26791,
  27246,  27684,  28106,  28511,  28899,  29269,  29622,  29957,
  30274,  30572,  30853,  31114,  31357,  31581,  31786,  31972,
  32138,  32286,  32413,  32522,  32610,  32679,  32729,  32758,
  32767,  32758,  32729,  32679,  32610,  32522,  32413,  32286,
  32138,  31972,  31786,  31581,  31357,  31114,  30853,  30572,
  30274,  29957,  29622,  29269,  28899,  28511,  28106,  27684,
  27246,  26791,  26320,  25833,  25330,  24812,  24279,  23732,
  23170,  22595,  22006,  21403,  20788,  20160,  19520,  18868,
  18205,  17531,  16846,  16151,  15447,  14733,  14010,  13279,
  12540,  11793,  11039,  10279,   9512,   8740,   7962,   7180,
   6393,   5602,   4808,   4011,   3212,   2411,   1608,    804,
};
#endif


#define SPM_A spmaddrA
#define SPM_B spmaddrB
#define SPM_C spmaddrC
#define SPM_D spmaddrD

// SPM_A offsets
int offset_i_e      = 0x0000;
int offset_i_o      = 0x0400;
int a1_offset       = 0x0800;
int b1_offset       = 0x0A00;
int a_offset        = 0x0C00;
int final_e1_offset = 0x3000;
int final_e2_offset = 0x3200;
int final_o1_offset = 0x3400;
int final_o2_offset = 0x3600;

// SPM_B offsets
int offset_j_e = 0x0000;
int offset_j_o = 0x0400;
int a2_offset  = 0x0800;
int b2_offset  = 0x0A00;
int b_offset   = 0x0C00;

// SPM_C offsets
int tr_offset = 0x0000;
int ti_offset = 0x0200;
int xr_offset = 0x0400;
int xi_offset = 0x0600;


// SPM_D offsets
int wpr128_offset = 0x0000;
int wpi128_offset = 0x0200;
int wpr64_offset  = 0x0400;
int wpi64_offset  = 0x0500;
int wpr32_offset  = 0x0600;
int wpi32_offset  = 0x0680;
int wpr16_offset  = 0x0700;
int wpi16_offset  = 0x0740;
int wpr8_offset   = 0x0780;
int wpi8_offset   = 0x07A0;
int wpr4_offset   = 0x07C0;
int wpi4_offset   = 0x07D0;
int wpr2_offset   = 0x07E0;
int wpi2_offset   = 0x07E8;

#if local_result == 0
  int data_Rf[256*3];
  int data_If[256*3];                              
#endif

// ----------------------------------------------------------------------------------------------------
// ----------------------------------------------------------------------------------------------------


//   ██████╗ ██████╗ ███╗   ██╗██╗   ██╗       ██████╗ ██████╗ 
//  ██╔════╝██╔═══██╗████╗  ██║██║   ██║       ╚════██╗██╔══██╗
//  ██║     ██║   ██║██╔██╗ ██║██║   ██║        █████╔╝██║  ██║
//  ██║     ██║   ██║██║╚██╗██║╚██╗ ██╔╝       ██╔═══╝ ██║  ██║
//  ╚██████╗╚██████╔╝██║ ╚████║ ╚████╔╝███████╗███████╗██████╔╝
//   ╚═════╝ ╚═════╝ ╚═╝  ╚═══╝  ╚═══╝ ╚══════╝╚══════╝╚═════╝ 

// ----------------------------------------------------------------------------------------------------
// ----------------------------------ZEROPADDED--------------------------------------------------------
// ----------------------------------------------------------------------------------------------------
#define REPLICATION 1 
#ifndef A_ORDER
#define A_ORDER 32 //Matrix size, don't do 2x2 case, for that i have another test
#endif
#ifndef B_ORDER
#define B_ORDER 3 //set to 3-5-7-9-11
#endif
// ----------------------------------------------------------------------------------------------------
#if B_ORDER == 3
#define Z_overhead 2
#endif
#define Z_ORDER (A_ORDER+Z_overhead)
// ----------------------------------------------------------------------------------------------------

#ifndef PRINT_NUM_CYCLES
#define PRINT_NUM_CYCLES 1 // to print the cycle count
#endif

#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include "dsp_functions.h"
#include "functions.h"
#include "klessydra_defs.h"

#define MULTI_TH 1

//don't change these :P

#define SPM_MAX 64
#define SIZE_OF_INT 4
#define K_COL (B_ORDER+1)

int dimension_Zero=Z_ORDER*Z_ORDER*sizeof(int);

// #define Z_ORDER A_ORDER
int mat_second_A[3][A_ORDER][A_ORDER];
int matB[B_ORDER*B_ORDER] = {0};
int sign;


int output_compare1[A_ORDER*A_ORDER]={0};


int conv2D_out_scal=5;

int azzero=0;
int memory_offset[3]={0};

int perf0[3] = {0, 0, 0};
int final_perf0[3] = {777, 777, 777};
int *ptr_perf0[3];

int perf1[3] = {0, 0, 0};
int final_perf1[3] = {777, 777, 777};
int  *ptr_perf1[3];

int perf2[3] = {0, 0, 0};
int final_perf2[3] = {777, 777, 777};
int *ptr_perf2[3];

int perf3[3] = {0, 0, 0};
int final_perf3[3] = {777, 777, 777};
int *ptr_perf3[3];

int perf4[3] = {0, 0, 0};
int final_perf4[3] = {777, 777, 777};
int *ptr_perf4[3];

int perf5[3] = {0, 0, 0};
int final_perf5[3] = {777, 777, 777};
int *ptr_perf5[3];

int perf6[3] = {0, 0, 0};
int final_perf6[3] = {777, 777, 777};
int *ptr_perf6[3];

int perf7[3] = {0, 0, 0};
int final_perf7[3] = {777, 777, 777};
int *ptr_perf7[3];

//------------------------------------------------------------------------------------------------------------
//------------------------------------------------------------------------------------------------------------

void matmul();

#if accl_test == 1
  void convolution2D_SPM_off_NOB_zeropadded_3(void* spm_dest,    void* spm_fm,   void* spm_krn,  void* spm_temp,  int size);
  void fft(int len);
#endif

#if accl_test == 0
  void convolution2D_Zeropadding_3(int size, int (*matrix)[size], int *kernel_tmp, int *out);
  void fft(short *data, int len); 
#endif

//------------------------------------------------------------------------------------------------------------
//------------------------------------------------------------------------------------------------------------


//  ███╗   ███╗ █████╗ ██╗███╗   ██╗
//  ████╗ ████║██╔══██╗██║████╗  ██║
//  ██╔████╔██║███████║██║██╔██╗ ██║
//  ██║╚██╔╝██║██╔══██║██║██║╚██╗██║
//  ██║ ╚═╝ ██║██║  ██║██║██║ ╚████║
//  ╚═╝     ╚═╝╚═╝  ╚═╝╚═╝╚═╝  ╚═══╝


//------------------------------------------------------------------------------------------------------------
//                                                 MAIN                                                       
//------------------------------------------------------------------------------------------------------------
int matmul_done = 0;
int conv2D_cnt = 0;
int fft_cnt = 0;
//int *conv2D_cnt_ptr = &conv2D_cnt;
//int *fft_cnt_ptr = &fft_cnt;

int main(){

  for (int i=0; i<3; i++){
    ptr_perf0[i] = &perf0[i];
    ptr_perf1[i] = &perf1[i];
    ptr_perf2[i] = &perf2[i];
    ptr_perf3[i] = &perf3[i];
    ptr_perf4[i] = &perf4[i];
    ptr_perf5[i] = &perf5[i];
    ptr_perf6[i] = &perf6[i];
    ptr_perf7[i] = &perf7[i];
  }

  int off_idx=0;

  memory_offset[0]=0;

  #if USE_KLESSYDRA_T == 1
    __asm__("csrw 0x300, 0x8;" );// each thread enables it's own interrupt
    __asm__("csrrw zero, mcycle, zero");
    sync_barrier_reset(); 
    sync_barrier_thread_registration();
  #endif

  #if accl_test == 0
    #if USE_KLESSYDRA_T == 1
      if (Klessydra_get_coreID() == 0) {
        sign=1;
        int increment=1000;
        for(int i=0; i<B_ORDER*B_ORDER; i++){
          matB[i]=(increment*1)<<8;
        }
        sign = 1;
        for(int i =0;i<A_ORDER; i++) {
          for(int j=0; j<A_ORDER; j++) {
            mat_second_A[0][i][j]=(increment*1)<<8;
            mat_second_A[1][i][j]=(20*sign*(i*A_ORDER+j+1))<<8;
            mat_second_A[2][i][j]=(3*sign*(i*A_ORDER+j+1))<<8;
            sign=sign*(-1);
          }
        }
      }
      else if (Klessydra_get_coreID() == 1) {
        for (int i = 0; i < NINPUTS; ++i) {
          buf[2 * i] = dataR1[i];
          buf[2 * i + 1] = dataI1[i];
        }
      }
    #endif
    #if USE_KLESSYDRA_T == 0
      sign=1;
      int increment=1000;
      for(int i=0; i<B_ORDER*B_ORDER; i++){
        matB[i]=(increment*1)<<8;
      }
      sign = 1;
      for(int i =0;i<A_ORDER; i++) {
        for(int j=0; j<A_ORDER; j++) {
          mat_second_A[0][i][j]=(increment*1)<<8;
          mat_second_A[1][i][j]=(20*sign*(i*A_ORDER+j+1))<<8;
          mat_second_A[2][i][j]=(3*sign*(i*A_ORDER+j+1))<<8;
          sign=sign*(-1);
        }
      }
      for (int i = 0; i < NINPUTS; ++i) {
        buf[2 * i] = dataR1[i];
        buf[2 * i + 1] = dataI1[i];
      } 
    #endif
  #endif

  #if accl_test == 1

    CSR_MVSIZE(SPM_MAX*SPM_MAX*sizeof(int));
    kbcast((void*)spmaddrA,(void*)azzero);
    kbcast((void*)spmaddrB,(void*)azzero);
    kbcast((void*)spmaddrC,(void*)azzero);
    kbcast((void*)spmaddrD,(void*)azzero);
    CSR_MVSIZE(dimension_Zero);

    if (Klessydra_get_coreID() == 1) {
      int wprBase128 = 0x800 + SPM_D+wpr128_offset;
      int wpiBase128 = 0x800 + SPM_D+wpi128_offset;
      int wprBase64  = 0x800 + SPM_D+wpr64_offset;
      int wpiBase64  = 0x800 + SPM_D+wpi64_offset;
      int wprBase32  = 0x800 + SPM_D+wpr32_offset;
      int wpiBase32  = 0x800 + SPM_D+wpi32_offset;
      int wprBase16  = 0x800 + SPM_D+wpr16_offset;
      int wpiBase16  = 0x800 + SPM_D+wpi16_offset;
      int wprBase8   = 0x800 + SPM_D+wpr8_offset;
      int wpiBase8   = 0x800 + SPM_D+wpi8_offset;
      int wprBase4   = 0x800 + SPM_D+wpr4_offset;
      int wpiBase4   = 0x800 + SPM_D+wpi4_offset;
      int wprBase2   = 0x800 + SPM_D+wpr2_offset;
      int wpiBase2   = 0x800 + SPM_D+wpi2_offset;

      kmemld((void*) wprBase128, (void*) wprBase128_mem, 4*128);
      kmemld((void*) wpiBase128, (void*) wpiBase128_mem, 4*128);
      kmemld((void*) wprBase64,  (void*) wprBase64_mem,  4*64);
      kmemld((void*) wpiBase64,  (void*) wpiBase64_mem,  4*64);
      kmemld((void*) wprBase32,  (void*) wprBase32_mem,  4*32);
      kmemld((void*) wpiBase32,  (void*) wpiBase32_mem,  4*32);
      kmemld((void*) wprBase16,  (void*) wprBase16_mem,  4*16);
      kmemld((void*) wpiBase16,  (void*) wpiBase16_mem,  4*16);
      kmemld((void*) wprBase8,   (void*) wprBase8_mem,   4*8);
      kmemld((void*) wpiBase8,   (void*) wpiBase8_mem,   4*8);
      kmemld((void*) wprBase4,   (void*) wprBase4_mem,   4*4);
      kmemld((void*) wpiBase4,   (void*) wpiBase4_mem,   4*4);
      kmemld((void*) wprBase2,   (void*) wprBase2_mem,   4*2);
      kmemld((void*) wpiBase2,   (void*) wpiBase2_mem,   4*2);
    }
  #endif

  #if USE_KLESSYDRA_T == 1
    sync_barrier();
    sync_barrier_thread_registration();
  #endif
  //--------------------------------------CONVOLUTIONS------------------------------------------
  int enable_perf_cnt = 0;
  #if USE_KLESSYDRA_T == 1
  if (Klessydra_get_coreID() == 0) {
    // ENABLE COUNTING -------------------------------------------------------------------------
    #ifdef PRINT_NUM_CYCLES
      final_perf0[0]=0;
      final_perf1[0]=0;
      final_perf2[0]=0;
      final_perf3[0]=0;
      final_perf4[0]=0;
      final_perf5[0]=0;
      final_perf6[0]=0;
      final_perf7[0]=0;
      __asm__("csrrw zero, mcycle, zero;"    // reset cycle count
          "csrrw zero, minstret, zero;"  // reset instruction count
          "csrrw zero, 0xB03, zero;"     // reset load store access stall count
          "csrrw zero, 0xB06, zero;"     // reset load count
          "csrrw zero, 0xB07, zero;"     // reset store count
          "csrrw zero, 0xB08, zero;"     // reset unconditional count
          "csrrw zero, 0xB09, zero;"     // reset branch count
          "csrrw zero, 0xB0A, zero;"     // reset taken branch count
          "li %[enable], 0x000003E7;"    // enable performance counters
          "csrrw zero, 0x7A0, %[enable]" // enable performance counters
          :
          :[enable] "r" (enable_perf_cnt)
      );
    #endif
    //------------------------------------------------------------------------------------------
    while (matmul_done != 1) {
      off_idx=0;
      #if accl_test == 1
        convolution2D_SPM_off_NOB_zeropadded_3(
            (void*)(  (int*)spmaddrC+  memory_offset[off_idx] ),
            (void*)(  (int*)spmaddrA+  memory_offset[off_idx] ), 
            (void*)(  (int*)spmaddrB+  memory_offset[off_idx] ), 
            (void*)(  (int*)spmaddrD+  memory_offset[off_idx] ),  Z_ORDER
            );
      #endif
      #if accl_test == 0
        convolution2D_Zeropadding_3(A_ORDER, mat_second_A[0],(int*)matB, (int*)output_compare1);
      #endif
      conv2D_cnt++;
      //__asm__("sw %[conv2D_cnt], 0(%[conv2D_cnt_ptr]);"
      //	:
      //	: [conv2D_cnt] "r" (conv2D_cnt), [conv2D_cnt_ptr] "r" (conv2D_cnt_ptr)
      //	: "memory"
      //	); 
    }
    // DISABLE COUNTING AND SAVE MCYCLE -------------------------------------------------------
    #ifdef PRINT_NUM_CYCLES
      __asm__("csrrw zero, 0x7A0, 0x00000000;" // disable performance counters
          "csrrw %[perf0], mcycle, zero;"
          "sw %[perf0], 0(%[ptr_perf0]);"
          "csrrw %[perf1], minstret, zero;"
          "sw %[perf1], 0(%[ptr_perf1]);"
          "csrrw %[perf2], 0xB03, zero;"
          "sw %[perf2], 0(%[ptr_perf2]);"
          "csrrw %[perf3], 0xB06, zero;"
          "sw %[perf3], 0(%[ptr_perf3]);"
          "csrrw %[perf4], 0xB07, zero;"
          "sw %[perf4], 0(%[ptr_perf4]);"
          "csrrw %[perf5], 0xB08, zero;"
          "sw %[perf5], 0(%[ptr_perf5]);"
          "csrrw %[perf6], 0xB09, zero;"
          "sw %[perf6], 0(%[ptr_perf6]);"
          "csrrw %[perf7], 0xB0A, zero;"
          "sw %[perf7], 0(%[ptr_perf7]);"
          :
          :[perf0] "r" (perf0[0]), [ptr_perf0] "r" (ptr_perf0[0]),
           [perf1] "r" (perf1[0]), [ptr_perf1] "r" (ptr_perf1[0]),
           [perf2] "r" (perf2[0]), [ptr_perf2] "r" (ptr_perf2[0]),
           [perf3] "r" (perf3[0]), [ptr_perf3] "r" (ptr_perf3[0]),
           [perf4] "r" (perf4[0]), [ptr_perf4] "r" (ptr_perf4[0]),
           [perf5] "r" (perf5[0]), [ptr_perf5] "r" (ptr_perf5[0]),
           [perf6] "r" (perf6[0]), [ptr_perf6] "r" (ptr_perf6[0]),
           [perf7] "r" (perf7[0]), [ptr_perf7] "r" (ptr_perf7[0])
      );
    #endif
    // //---------------------------------------------------------------------------------------
  }

  //------------------------------------------ FFT ---------------------------------------------
  if (Klessydra_get_coreID() == 1) {
    // ENABLE COUNTING -------------------------------------------------------------------------
    #ifdef PRINT_NUM_CYCLES
      final_perf0[1]=0;
      final_perf1[1]=0;
      final_perf2[1]=0;
      final_perf3[1]=0;
      final_perf4[1]=0;
      final_perf5[1]=0;
      final_perf6[1]=0;
      final_perf7[1]=0;
      __asm__("csrrw zero, mcycle, zero;"    // reset cycle count
          "csrrw zero, minstret, zero;"  // reset instruction count
          "csrrw zero, 0xB03, zero;"     // reset load store access stall count
          "csrrw zero, 0xB06, zero;"     // reset load count
          "csrrw zero, 0xB07, zero;"     // reset store count
          "csrrw zero, 0xB08, zero;"     // reset unconditional count
          "csrrw zero, 0xB09, zero;"     // reset branch count
          "csrrw zero, 0xB0A, zero;"     // reset taken branch count
          "li %[enable], 0x000003E7;"    // enable performance counters
          "csrrw zero, 0x7A0, %[enable]" // enable performance counters
          :
          :[enable] "r" (enable_perf_cnt)
      );
    #endif
    //------------------------------------------------------------------------------------------
    while (matmul_done != 1) {
      #if accl_test == 1
        fft(256);
      #endif
      #if accl_test == 0
        fft(buf, NINPUTS);
      #endif
      fft_cnt++;
      //__asm__("sw %[fft_cnt], 0(%[fft_cnt_ptr]);"
      //	:
      //	: [fft_cnt] "r" (fft_cnt), [fft_cnt_ptr] "r" (fft_cnt_ptr)
      //	: "memory"
      //	); 
    }
    // DISABLE COUNTING AND SAVE MCYCLE -------------------------------------------------------
    #ifdef PRINT_NUM_CYCLES
      __asm__("csrrw zero, 0x7A0, 0x00000000;" // disable performance counters
          "csrrw %[perf0], mcycle, zero;"
          "sw %[perf0], 0(%[ptr_perf0]);"
          "csrrw %[perf1], minstret, zero;"
          "sw %[perf1], 0(%[ptr_perf1]);"
          "csrrw %[perf2], 0xB03, zero;"
          "sw %[perf2], 0(%[ptr_perf2]);"
          "csrrw %[perf3], 0xB06, zero;"
          "sw %[perf3], 0(%[ptr_perf3]);"
          "csrrw %[perf4], 0xB07, zero;"
          "sw %[perf4], 0(%[ptr_perf4]);"
          "csrrw %[perf5], 0xB08, zero;"
          "sw %[perf5], 0(%[ptr_perf5]);"
          "csrrw %[perf6], 0xB09, zero;"
          "sw %[perf6], 0(%[ptr_perf6]);"
          "csrrw %[perf7], 0xB0A, zero;"
          "sw %[perf7], 0(%[ptr_perf7]);"
          :
          :[perf0] "r" (perf0[1]), [ptr_perf0] "r" (ptr_perf0[1]),
           [perf1] "r" (perf1[1]), [ptr_perf1] "r" (ptr_perf1[1]),
           [perf2] "r" (perf2[1]), [ptr_perf2] "r" (ptr_perf2[1]),
           [perf3] "r" (perf3[1]), [ptr_perf3] "r" (ptr_perf3[1]),
           [perf4] "r" (perf4[1]), [ptr_perf4] "r" (ptr_perf4[1]),
           [perf5] "r" (perf5[1]), [ptr_perf5] "r" (ptr_perf5[1]),
           [perf6] "r" (perf6[1]), [ptr_perf6] "r" (ptr_perf6[1]),
           [perf7] "r" (perf7[1]), [ptr_perf7] "r" (ptr_perf7[1])
      );
    #endif
    // //---------------------------------------------------------------------------------------
  }

  //---------------------------------------- MATMUL --------------------------------------------
  if (Klessydra_get_coreID() == 2) {
    // ENABLE COUNTING -------------------------------------------------------------------------
    #ifdef PRINT_NUM_CYCLES
      final_perf0[2]=0;
      final_perf1[2]=0;
      final_perf2[2]=0;
      final_perf3[2]=0;
      final_perf4[2]=0;
      final_perf5[2]=0;
      final_perf6[2]=0;
      final_perf7[2]=0;
      __asm__("csrrw zero, mcycle, zero;"    // reset cycle count
          "csrrw zero, minstret, zero;"  // reset instruction count
          "csrrw zero, 0xB03, zero;"     // reset load store access stall count
          "csrrw zero, 0xB06, zero;"     // reset load count
          "csrrw zero, 0xB07, zero;"     // reset store count
          "csrrw zero, 0xB08, zero;"     // reset unconditional count
          "csrrw zero, 0xB09, zero;"     // reset branch count
          "csrrw zero, 0xB0A, zero;"     // reset taken branch count
          "li %[enable], 0x000003E7;"    // enable performance counters
          "csrrw zero, 0x7A0, %[enable]" // enable performance counters
          :
          :[enable] "r" (enable_perf_cnt)
      );
    #endif
    //------------------------------------------------------------------------------------------
    for (int l=0; l<1; l++) {
      #ifdef accl_test == 1
        matmul();
      #else
        int n=N_ROW_1;
        int m=N_COL_1;
        int u=N_COL_2;
        int vect[u];
        int k,p;
        int m_out[n][u];
        for(int i=0;i<n;i++){
        	for(int j=0;j<u;j++){
        		m_out[i][j]=0;
        		vect[j]=0;
        	}
        }
        for(int i=0;i<n;i++){
        	for(int j=0;j<m;j++){
        		for(int k=0;k<u;k++){
        			vect[k]+=m1[i][j]*m2[j][k];
        		}
        		
        	}
        	for(int j=0;j<u;j++){
        		m_out[i][j]=vect[j];
        		vect[j]=0;
        	}
        }
      #endif
      matmul_done = 1;
    }
    // DISABLE COUNTING AND SAVE MCYCLE -------------------------------------------------------
    #ifdef PRINT_NUM_CYCLES
      __asm__("csrrw zero, 0x7A0, 0x00000000;" // disable performance counters
          "csrrw %[perf0], mcycle, zero;"
          "sw %[perf0], 0(%[ptr_perf0]);"
          "csrrw %[perf1], minstret, zero;"
          "sw %[perf1], 0(%[ptr_perf1]);"
          "csrrw %[perf2], 0xB03, zero;"
          "sw %[perf2], 0(%[ptr_perf2]);"
          "csrrw %[perf3], 0xB06, zero;"
          "sw %[perf3], 0(%[ptr_perf3]);"
          "csrrw %[perf4], 0xB07, zero;"
          "sw %[perf4], 0(%[ptr_perf4]);"
          "csrrw %[perf5], 0xB08, zero;"
          "sw %[perf5], 0(%[ptr_perf5]);"
          "csrrw %[perf6], 0xB09, zero;"
          "sw %[perf6], 0(%[ptr_perf6]);"
          "csrrw %[perf7], 0xB0A, zero;"
          "sw %[perf7], 0(%[ptr_perf7]);"
          :
          :[perf0] "r" (perf0[2]), [ptr_perf0] "r" (ptr_perf0[2]),
           [perf1] "r" (perf1[2]), [ptr_perf1] "r" (ptr_perf1[2]),
           [perf2] "r" (perf2[2]), [ptr_perf2] "r" (ptr_perf2[2]),
           [perf3] "r" (perf3[2]), [ptr_perf3] "r" (ptr_perf3[2]),
           [perf4] "r" (perf4[2]), [ptr_perf4] "r" (ptr_perf4[2]),
           [perf5] "r" (perf5[2]), [ptr_perf5] "r" (ptr_perf5[2]),
           [perf6] "r" (perf6[2]), [ptr_perf6] "r" (ptr_perf6[2]),
           [perf7] "r" (perf7[2]), [ptr_perf7] "r" (ptr_perf7[2])
      );
    #endif
    // //---------------------------------------------------------------------------------------
  }
  sync_barrier();
  //--------------------------------------PRINT PERF -------------------------------------------
  sync_barrier_thread_registration();
  if (Klessydra_get_coreID() == 2) {
    #ifdef PRINT_NUM_CYCLES
        for (int i=0; i<3; i++){
        final_perf0[i]=*(ptr_perf0[i]);
        final_perf1[i]=*(ptr_perf1[i]);
        final_perf2[i]=*(ptr_perf2[i]);
        final_perf3[i]=*(ptr_perf3[i]);
        final_perf4[i]=*(ptr_perf4[i]);
        final_perf5[i]=*(ptr_perf5[i]);
        final_perf6[i]=*(ptr_perf6[i]);
        final_perf7[i]=*(ptr_perf7[i]);
        }
      printf("\n");
      for (int i=0; i<3; i++) {
      	if (i == 0) {
          printf("conv2D_cnt = %d \n", conv2D_cnt);
          printf(" Cycle Count = %d \n Instruction Count = %d \n Instruction wait = %d \n Load Count = %d \n Store Count = %d \n Unconditional Jump Count = %d \n Branch Count = %d \n Taken Count = %d \n \n", 
               final_perf0[i]/conv2D_cnt, final_perf1[i]/conv2D_cnt, final_perf2[i]/conv2D_cnt, final_perf3[i]/conv2D_cnt, final_perf4[i]/conv2D_cnt, final_perf5[i]/conv2D_cnt, final_perf6[i]/conv2D_cnt, final_perf7[i]/conv2D_cnt);
        }
      	else if (i == 1) {
          printf("fft_cnt = %d \n", fft_cnt);
          printf(" Cycle Count = %d \n Instruction Count = %d \n Instruction wait = %d \n Load Count = %d \n Store Count = %d \n Unconditional Jump Count = %d \n Branch Count = %d \n Taken Count = %d \n \n", 
               final_perf0[i]/fft_cnt, final_perf1[i]/fft_cnt, final_perf2[i]/fft_cnt, final_perf3[i]/fft_cnt, final_perf4[i]/fft_cnt, final_perf5[i]/fft_cnt, final_perf6[i]/fft_cnt, final_perf7[i]/fft_cnt);
        }
        else {
          printf(" Cycle Count = %d \n Instruction Count = %d \n Instruction wait = %d \n Load Count = %d \n Store Count = %d \n Unconditional Jump Count = %d \n Branch Count = %d \n Taken Count = %d \n \n", 
               final_perf0[i], final_perf1[i], final_perf2[i], final_perf3[i], final_perf4[i], final_perf5[i], final_perf6[i], final_perf7[i]);
          return 0;
        }
      }
    #endif
  }
  sync_barrier();
  #endif

  #if USE_KLESSYDRA_T == 0
	#ifdef PRINT_NUM_CYCLES
		// ENABLE COUNTING -------------------------------------------------------------------------
		final_perf0[0]=0;
		final_perf1[0]=0;
		final_perf2[0]=0;
		final_perf3[0]=0;
		final_perf4[0]=0;
		final_perf5[0]=0;
		final_perf6[0]=0;
		final_perf7[0]=0;
		__asm__("csrrw zero, 0x780, zero;"  // reset cycle count
				"csrrw zero, 0x781, zero;"  // reset instruction count
				"csrrw zero, 0x784, zero;"  // reset instruction wait count
				"csrrw zero, 0x785, zero;"  // reset memory load count
				"csrrw zero, 0x786, zero;"  // reset memory store count
				"csrrw zero, 0x787, zero;"  // reset uncoditional jump count
				"csrrw zero, 0x788, zero;"  // reset branch count
				"csrrw zero, 0x789, zero;"  // reset taken branch count
				"li %[enable], 0x000003F3;"  // 
				"csrrw zero, 0x7A0, %[enable]" // enable performance counters
				:
				:[enable] "r" (enable_perf_cnt)
		);
	#endif
      convolution2D_Zeropadding_3(A_ORDER, mat_second_A[0],(int*)matB, (int*)output_compare1); 
	// DISABLE COUNTING AND SAVE MCYCLE -------------------------------------------------------
	#ifdef PRINT_NUM_CYCLES
	// -------------------------------------------------------------------------------------------------------------------
		// DISABLE COUNTING AND SAVE MCYCLE -------------------------------------------------------
		__asm__("csrrw zero, 0x7A0, 0x00000000;" // disable performance counters
				"csrrw %[perf0], 0x780, zero;"
				"sw %[perf0], 0(%[ptr_perf0]);"
				"csrrw %[perf1], 0x781, zero;"
				"sw %[perf1], 0(%[ptr_perf1]);"
				"csrrw %[perf2], 0x784, zero;"
				"sw %[perf2], 0(%[ptr_perf2]);"
				"csrrw %[perf3], 0x785, zero;"
				"sw %[perf3], 0(%[ptr_perf3]);"
				"csrrw %[perf4], 0x786, zero;"
				"sw %[perf4], 0(%[ptr_perf4]);"
				"csrrw %[perf5], 0x787, zero;"
				"sw %[perf5], 0(%[ptr_perf5]);"
				:
				:[perf0] "r" (perf0[0]), [ptr_perf0] "r" (ptr_perf0[0]),
				 [perf1] "r" (perf1[0]), [ptr_perf1] "r" (ptr_perf1[0]),
				 [perf2] "r" (perf2[0]), [ptr_perf2] "r" (ptr_perf2[0]),
				 [perf3] "r" (perf3[0]), [ptr_perf3] "r" (ptr_perf3[0]),
				 [perf4] "r" (perf4[0]), [ptr_perf4] "r" (ptr_perf4[0]),
				 [perf5] "r" (perf5[0]), [ptr_perf5] "r" (ptr_perf5[0])
		);
		__asm__("csrrw %[perf6], 0x788, zero;"
				"sw %[perf6], 0(%[ptr_perf6]);"
				"csrrw %[perf7], 0x789, zero;"
				"sw %[perf7], 0(%[ptr_perf7]);"
				:
				:[perf6] "r" (perf6[0]), [ptr_perf6] "r" (ptr_perf6[0]),
				 [perf7] "r" (perf7[0]), [ptr_perf7] "r" (ptr_perf7[0])
		);
	#endif
	//------------------------------------------------------------------------------------------
	#ifdef PRINT_NUM_CYCLES
		// ENABLE COUNTING -------------------------------------------------------------------------
		final_perf0[1]=0;
		final_perf1[1]=0;
		final_perf2[1]=0;
		final_perf3[1]=0;
		final_perf4[1]=0;
		final_perf5[1]=0;
		final_perf6[1]=0;
		final_perf7[1]=0;
		__asm__("csrrw zero, 0x780, zero;"  // reset cycle count
				"csrrw zero, 0x781, zero;"  // reset instruction count
				"csrrw zero, 0x784, zero;"  // reset instruction wait count
				"csrrw zero, 0x785, zero;"  // reset memory load count
				"csrrw zero, 0x786, zero;"  // reset memory store count
				"csrrw zero, 0x787, zero;"  // reset uncoditional jump count
				"csrrw zero, 0x788, zero;"  // reset branch count
				"csrrw zero, 0x789, zero;"  // reset taken branch count
				"li %[enable], 0x000003F3;"  // 
				"csrrw zero, 0x7A0, %[enable]" // enable performance counters
				:
				:[enable] "r" (enable_perf_cnt)
		);
	#endif
      fft(buf, NINPUTS); 
	// DISABLE COUNTING AND SAVE MCYCLE -------------------------------------------------------
	#ifdef PRINT_NUM_CYCLES
	// -------------------------------------------------------------------------------------------------------------------
		// DISABLE COUNTING AND SAVE MCYCLE -------------------------------------------------------
		__asm__("csrrw zero, 0x7A0, 0x00000000;" // disable performance counters
				"csrrw %[perf0], 0x780, zero;"
				"sw %[perf0], 0(%[ptr_perf0]);"
				"csrrw %[perf1], 0x781, zero;"
				"sw %[perf1], 0(%[ptr_perf1]);"
				"csrrw %[perf2], 0x784, zero;"
				"sw %[perf2], 0(%[ptr_perf2]);"
				"csrrw %[perf3], 0x785, zero;"
				"sw %[perf3], 0(%[ptr_perf3]);"
				"csrrw %[perf4], 0x786, zero;"
				"sw %[perf4], 0(%[ptr_perf4]);"
				"csrrw %[perf5], 0x787, zero;"
				"sw %[perf5], 0(%[ptr_perf5]);"
				:
				:[perf0] "r" (perf0[1]), [ptr_perf0] "r" (ptr_perf0[1]),
				 [perf1] "r" (perf1[1]), [ptr_perf1] "r" (ptr_perf1[1]),
				 [perf2] "r" (perf2[1]), [ptr_perf2] "r" (ptr_perf2[1]),
				 [perf3] "r" (perf3[1]), [ptr_perf3] "r" (ptr_perf3[1]),
				 [perf4] "r" (perf4[1]), [ptr_perf4] "r" (ptr_perf4[1]),
				 [perf5] "r" (perf5[1]), [ptr_perf5] "r" (ptr_perf5[1])
		);
		__asm__("csrrw %[perf6], 0x788, zero;"
				"sw %[perf6], 0(%[ptr_perf6]);"
				"csrrw %[perf7], 0x789, zero;"
				"sw %[perf7], 0(%[ptr_perf7]);"
				:
				:[perf6] "r" (perf6[1]), [ptr_perf6] "r" (ptr_perf6[1]),
				 [perf7] "r" (perf7[1]), [ptr_perf7] "r" (ptr_perf7[1])
		);
	#endif
	//------------------------------------------------------------------------------------------
	#ifdef PRINT_NUM_CYCLES
		// ENABLE COUNTING -------------------------------------------------------------------------
		final_perf0[2]=0;
		final_perf1[2]=0;
		final_perf2[2]=0;
		final_perf3[2]=0;
		final_perf4[2]=0;
		final_perf5[2]=0;
		final_perf6[2]=0;
		final_perf7[2]=0;
		__asm__("csrrw zero, 0x780, zero;"  // reset cycle count
				"csrrw zero, 0x781, zero;"  // reset instruction count
				"csrrw zero, 0x784, zero;"  // reset instruction wait count
				"csrrw zero, 0x785, zero;"  // reset memory load count
				"csrrw zero, 0x786, zero;"  // reset memory store count
				"csrrw zero, 0x787, zero;"  // reset uncoditional jump count
				"csrrw zero, 0x788, zero;"  // reset branch count
				"csrrw zero, 0x789, zero;"  // reset taken branch count
				"li %[enable], 0x000003F3;"  // 
				"csrrw zero, 0x7A0, %[enable]" // enable performance counters
				:
				:[enable] "r" (enable_perf_cnt)
		);
	#endif
	// MATMUL START
      int n=N_ROW_1;
      int m=N_COL_1;
      int u=N_COL_2;
      int vect[u];
      int k,p;
      int m_out[n][u];
      for(int i=0;i<n;i++){
      	for(int j=0;j<u;j++){
      		m_out[i][j]=0;
      		vect[j]=0;
      	}
      }
      for(int i=0;i<n;i++){
      	for(int j=0;j<m;j++){
      		for(int k=0;k<u;k++){
      			vect[k]+=m1[i][j]*m2[j][k];
      		}
      		
      	}
      	for(int j=0;j<u;j++){
      		m_out[i][j]=vect[j];
      		vect[j]=0;
      	}
      }
    // MATMUL END
    // DISABLE COUNTING AND SAVE MCYCLE -------------------------------------------------------
	#ifdef PRINT_NUM_CYCLES
	// -------------------------------------------------------------------------------------------------------------------
		// DISABLE COUNTING AND SAVE MCYCLE -------------------------------------------------------
		__asm__("csrrw zero, 0x7A0, 0x00000000;" // disable performance counters
				"csrrw %[perf0], 0x780, zero;"
				"sw %[perf0], 0(%[ptr_perf0]);"
				"csrrw %[perf1], 0x781, zero;"
				"sw %[perf1], 0(%[ptr_perf1]);"
				"csrrw %[perf2], 0x784, zero;"
				"sw %[perf2], 0(%[ptr_perf2]);"
				"csrrw %[perf3], 0x785, zero;"
				"sw %[perf3], 0(%[ptr_perf3]);"
				"csrrw %[perf4], 0x786, zero;"
				"sw %[perf4], 0(%[ptr_perf4]);"
				"csrrw %[perf5], 0x787, zero;"
				"sw %[perf5], 0(%[ptr_perf5]);"
				:
				:[perf0] "r" (perf0[2]), [ptr_perf0] "r" (ptr_perf0[2]),
				 [perf1] "r" (perf1[2]), [ptr_perf1] "r" (ptr_perf1[2]),
				 [perf2] "r" (perf2[2]), [ptr_perf2] "r" (ptr_perf2[2]),
				 [perf3] "r" (perf3[2]), [ptr_perf3] "r" (ptr_perf3[2]),
				 [perf4] "r" (perf4[2]), [ptr_perf4] "r" (ptr_perf4[2]),
				 [perf5] "r" (perf5[2]), [ptr_perf5] "r" (ptr_perf5[2])
		);
		__asm__("csrrw %[perf6], 0x788, zero;"
				"sw %[perf6], 0(%[ptr_perf6]);"
				"csrrw %[perf7], 0x789, zero;"
				"sw %[perf7], 0(%[ptr_perf7]);"
				:
				:[perf6] "r" (perf6[2]), [ptr_perf6] "r" (ptr_perf6[2]),
				 [perf7] "r" (perf7[2]), [ptr_perf7] "r" (ptr_perf7[2])
		);
	#endif
	//------------------------------------------------------------------------------------------
    #ifdef PRINT_NUM_CYCLES
        for (int i=0; i<3; i++){
          final_perf0[i]=*(ptr_perf0[i]);
          final_perf1[i]=*(ptr_perf1[i]);
          final_perf2[i]=*(ptr_perf2[i]);
          final_perf3[i]=*(ptr_perf3[i]);
          final_perf4[i]=*(ptr_perf4[i]);
          final_perf5[i]=*(ptr_perf5[i]);
          final_perf6[i]=*(ptr_perf6[i]);
          final_perf7[i]=*(ptr_perf7[i]);
        }
      printf("\n");
      for (int i=0; i<3; i++) {
        printf(" Cycle Count = %d \n Instruction Count = %d \n Instruction wait = %d \n Load Count = %d \n Store Count = %d \n Unconditional Jump Count = %d \n Branch Count = %d \n Taken Count = %d \n \n", 
             final_perf0[i], final_perf1[i], final_perf2[i], final_perf3[i], final_perf4[i], final_perf5[i], final_perf6[i], final_perf7[i]);
      }
    #endif
  #endif

  return 0;
}
// // --------------------------------------------------------------------------------------------------------------------------------
// // --------------------------------------------------------------------------------------------------------------------------------
#if accl_test == 1 
void convolution2D_SPM_off_NOB_zeropadded_3(void* spm_dest,    void* spm_fm,   void* spm_krn,  void* spm_temp,  int size) {
  int print=0;
  //Pointers to Spms and other index that i'll need for the convolution
  // void* spmaddrAoff= (void*)((int*)spm_fm + mem_off );
  void* spmaddrAoff= (void*)(spm_fm);
  void* spmaddrBoff= (void*)(spm_krn );
  void* spmaddrCoff= (void*)(spm_dest);
  void* spmaddrDoff= (void*)(spmaddrBoff+3*3*SIZE_OF_INT);

  void* dest_in_C;
  void* dest_in_B;
  void* dest_in_D;

  int k_element=0;
  int mat_int_shift=0; //internal shifting for properly pointing insied the spms while making kaddv

  int jump_kr_row=3; // determina il salto della riga per la matrice kernel zeropadded
  int kern_offset=0;
  int fm_offset=0;
  int zero=0;
  //______________________________sub_kernel E
  int kernel_width=3;
  int str_diff=2; //structural difference
  int centering_offset=1;
  CSR_MVSIZE((size-str_diff)*SIZE_OF_INT);
  
  for(int i=centering_offset; i< (size)-centering_offset;i++) {
    for (int rw_pt=-centering_offset; rw_pt <= centering_offset; rw_pt++) {
      //rw_pt is an index i use to point to the correct row, regarding this loop that is executed three times
      //instead of making 9 different ksvmulrf
      for (int clm_pt=0 ; clm_pt<kernel_width; clm_pt++){
        ksvmulsc((void*)( (int*)  (spmaddrDoff) ) + SIZE_OF_INT*(size*i)+centering_offset*SIZE_OF_INT,
                  (void*) ( (int*)spmaddrAoff + (i+rw_pt)*size  + clm_pt ),
                  (void*) ( (int*)spmaddrBoff+k_element++) );

        ksrav((void*)(  (int*)  (spmaddrDoff) ) + SIZE_OF_INT*(size*i)+centering_offset*SIZE_OF_INT,
                (void*)(  (int*)  (spmaddrDoff) ) + SIZE_OF_INT*(size*i)+centering_offset*SIZE_OF_INT,
                (int*)conv2D_out_scal);

        kaddv ((void*)( (int*)    (spmaddrCoff) ) + SIZE_OF_INT*(size*i)+centering_offset*SIZE_OF_INT,
                (void*)(  (int*)  (spmaddrCoff) ) + SIZE_OF_INT*(size*i)+centering_offset*SIZE_OF_INT,
                (void*)(  (int*)  (spmaddrDoff) ) + SIZE_OF_INT*(size*i)+centering_offset*SIZE_OF_INT);
      }
    }
    k_element=0;
  }
  ksvmulrf((void*)spmaddrDoff,(void*)spmaddrDoff,(void*)zero);
}
#endif

#if accl_test == 0
void convolution2D_Zeropadding_3(int size, int (*matrix)[size], int *kernel_tmp, int *out) {
	#define Krn_3 3
	#define structural_diff_3 2
		#define Z_MAT_3 A_ORDER + structural_diff_3
	int str_diff=2;
	int centering_offset=1;
	
	int print=0;
	int conv2D_scaling_factor=8;
	int conv2D_out_scal=5;
	int i, j;
	int pt=0;
	int k_index=0;
	
	int kernel[Krn_3*Krn_3];
	for(int i=0;i<Krn_3*Krn_3;i++){
    	kernel[i]=(kernel_tmp[i]>>conv2D_scaling_factor);
	}
	
	// int zeropad[A_ORDER+str_diff][A_ORDER+str_diff]={0};	
	int zeropad[Z_MAT_3][Z_MAT_3]={0};	
	for (int i= centering_offset; i	< A_ORDER	+	str_diff	-	centering_offset	; i++) {
		for (int j= centering_offset; j	< A_ORDER	+	str_diff	-	centering_offset	; j++) {
			zeropad[i][j]=matrix[i-centering_offset][j-centering_offset];
		}
	}
	
	// kernel 	E centrale
	for (i = centering_offset ; i < A_ORDER	+	str_diff	-centering_offset	; i++)
	{
		for (int ROW_k_SCAN= -centering_offset; ROW_k_SCAN <= centering_offset; ROW_k_SCAN++){
			for (int CLM_k_SCAN= -centering_offset; CLM_k_SCAN <= centering_offset; CLM_k_SCAN++){
				for (j = centering_offset ; j < A_ORDER	+	str_diff	-centering_offset	; j++){
					out[(i-centering_offset)*size+(j-centering_offset)] +=		(	(	(zeropad[i + ROW_k_SCAN][j + CLM_k_SCAN]>>conv2D_scaling_factor) 	* kernel[k_index])>>		conv2D_out_scal);
				}
				k_index++;
			}
		}
		k_index=0;
	}
}
#endif

// // --------------------------------------------------------------------------------------------------------------------------------
// // --------------------------------------------------------------------------------------------------------------------------------


//  ███████╗███████╗████████╗
//  ██╔════╝██╔════╝╚══██╔══╝
//  █████╗  █████╗     ██║   
//  ██╔══╝  ██╔══╝     ██║   
//  ██║     ██║        ██║   
//  ╚═╝     ╚═╝        ╚═╝   

#if accl_test == 1
void fft(int len) {

  #if local_result == 1
    int data_Rf_local[256*3];
    int data_If_local[256*3];
  #endif

  int wprBase128 = 0x800 + SPM_D+wpr128_offset;
  int wpiBase128 = 0x800 + SPM_D+wpi128_offset;
  int wprBase64  = 0x800 + SPM_D+wpr64_offset;
  int wpiBase64  = 0x800 + SPM_D+wpi64_offset;
  int wprBase32  = 0x800 + SPM_D+wpr32_offset;
  int wpiBase32  = 0x800 + SPM_D+wpi32_offset;
  int wprBase16  = 0x800 + SPM_D+wpr16_offset;
  int wpiBase16  = 0x800 + SPM_D+wpi16_offset;
  int wprBase8   = 0x800 + SPM_D+wpr8_offset;
  int wpiBase8   = 0x800 + SPM_D+wpi8_offset;
  int wprBase4   = 0x800 + SPM_D+wpr4_offset;
  int wpiBase4   = 0x800 + SPM_D+wpi4_offset;
  int wprBase2   = 0x800 + SPM_D+wpr2_offset;
  int wpiBase2   = 0x800 + SPM_D+wpi2_offset;


  int vect_i_e = 0x1000 + SPM_A+offset_i_e;
  int vect_i_o = 0x1000 + SPM_A+offset_i_o;
  int vect_j_e = 0x1000 + SPM_B+offset_j_e;
  int vect_j_o = 0x1000 + SPM_B+offset_j_o;

  // Base addresses
  int xr = SPM_C + xr_offset;
  int xi = SPM_C + xi_offset;
  int tr = SPM_C + tr_offset;
  int ti = SPM_C + ti_offset;
  int a1 = SPM_A + a1_offset;
  int a2 = SPM_B + a2_offset;
  int a  = SPM_A + a_offset;
  int b1 = SPM_A + b1_offset;
  int b2 = SPM_B + b2_offset;
  int b  = SPM_B + b_offset;

  int max = len;
  len <<= 1;

  kmemld((void*) vect_i_e, (void*) dataR,   4*NINPUTS/2);
  kmemld((void*) vect_j_e + (4*NINPUTS/2), (void*) dataR + (4*NINPUTS/2), 4*NINPUTS/2);
  kmemld((void*) vect_i_o, (void*) dataI,   4*NINPUTS/2);
  kmemld((void*) vect_j_o + (4*NINPUTS/2), (void*) dataI + (4*NINPUTS/2), 4*NINPUTS/2);

  while (max > 2) {

    int *wpr;
    int *wpi;

    if (max == 256) { 
      wpr = (int*) wprBase128;
      wpi = (int*) wpiBase128;
    }
    else if (max == 128) { 
      wpr = (int*) wprBase64;
      wpi = (int*) wpiBase64;
    }
    else if (max == 64) {
      wpr = (int*) wprBase32;
      wpi = (int*) wpiBase32;
    }
    else if (max == 32) {
      wpr = (int*) wprBase16;
      wpi = (int*) wpiBase16;
    }
    else if (max == 16) {
      wpr = (int*) wprBase8;
      wpi = (int*) wpiBase8;
    }
    else if (max == 8) {
      wpr = (int*) wprBase4;
      wpi = (int*) wpiBase4;
    }
    else if (max == 4) {
      wpr = (int*) wprBase2;
      wpi = (int*) wpiBase2;
    }

    CSR_MVSIZE(4*max/2); // max/2 since data[i] and data[i+1] are divided into two different vectors so m+=2 becomes m+=1

    int step = max/2 << 1;

    for (int i = 0; i < len/2; i += step) {

      // loop varying addresses
      int vect_i_e_pos = vect_i_e + 4*i;
      int vect_i_o_pos = vect_i_o + 4*i;
      int vect_j_e_pos = vect_j_e + 4*i + 4*(max/2); // Addresses have always byte percision hence 4*(max/2) instead of max/2
      int vect_j_o_pos = vect_j_o + 4*i + 4*(max/2); // Addresses have always byte percision hence 4*(max/2) instead of max/2

      int a1_pos = 0x1000 + a1 + 4*(i/2);
      int a2_pos = 0x1000 + a2 + 4*(i/2);
      int a_pos  = 0x1000 + a  + 4*(i/2); 

      int b1_pos = 0x1000 + b1 + 4*(i/2);
      int b2_pos = 0x1000 + b2 + 4*(i/2);
      int b_pos  = 0x1000 + b  + 4*(i/2);

      int tr_pos = 0x800 + tr + 4*(i/2);
      int ti_pos = 0x800 + ti + 4*(i/2);

      int xr_pos = 0x800 + xr + 4*(i/2);
      int xi_pos = 0x800 + xi + 4*(i/2);

      ksubv((void*) tr_pos, (void*) vect_i_e_pos, (void*) vect_j_e_pos); // spm_c = spm_a + spm_b
      ksubv((void*) ti_pos, (void*) vect_i_o_pos, (void*) vect_j_o_pos); // spm_c = spm_a + spm_b

      kvmul((void*)    a1_pos, (void*) wpr,    (void*) tr_pos); // spm_a <= spm_d * spm_c
      kvmul((void*)    a2_pos, (void*) wpi,    (void*) ti_pos); // spm_b <= spm_d * spm_c
      kaddv((void*)    a_pos,  (void*) a1_pos, (void*) a2_pos); // spm_a <= spm_a + spm_b
      kvmul((void*)    b1_pos, (void*) wpr,    (void*) ti_pos); // spm_a <= spm_d * spm_c
      kvmul((void*)    b2_pos, (void*) wpi,    (void*) tr_pos); // spm_b <= spm_d * spm_c
      ksubv((void*)    b_pos,  (void*) b1_pos, (void*) b2_pos); // spm_b <= spm_a - spm_b
      ksvmulrf((void*) xr_pos, (void*) a_pos,  (void*) 2);      // spm_c <= spm_a * scal
      ksvaddrf((void*) xr_pos, (void*) xr_pos, (void*) 0x8000); // spm_c <= spm_c + scal
      ksvmulrf((void*) xi_pos, (void*) b_pos,  (void*) 2);      // spm_c <= spm_b + scal
      ksvaddrf((void*) xi_pos, (void*) xi_pos, (void*) 0x8000); // spm_c <= spm_c + scal

      CSR_MVSIZE(4*max/4);
      if (max == 4) {
        int vect_i_e_final = vect_i_e + 2*i;
        int vect_i_o_final = vect_i_o + 2*i;
        int vect_j_e_final = vect_j_e + 2*i;
        int vect_j_o_final = vect_j_o + 2*i;
        kaddv((void*) vect_i_e_final, (void*) vect_i_e_pos, (void*) vect_j_e_pos);
        kaddv((void*) vect_j_e_final, (void*) vect_i_e_pos+4, (void*) vect_j_e_pos+4); 
        ksrav((void*) vect_i_e_final+4, (void*) xr_pos, (void*) 16);
        ksrav((void*) vect_j_e_final+4, (void*) xr_pos+4, (void*) 16);
        kaddv((void*) vect_i_o_final, (void*) vect_i_o_pos, (void*) vect_j_o_pos);
        kaddv((void*) vect_j_o_final, (void*) vect_i_o_pos+4, (void*) vect_j_o_pos+4);
        ksrav((void*) vect_i_o_final+4, (void*) xi_pos, (void*) 16);
        ksrav((void*) vect_j_o_final+4, (void*) xi_pos+4, (void*) 16);
      }
      else {
        kaddv((void*) vect_i_e_pos, (void*) vect_i_e_pos, (void*) vect_j_e_pos);
        kaddv((void*) vect_j_e_pos-4*(max/4), (void*) vect_i_e_pos+4*(max/4), (void*) vect_j_e_pos+4*(max/4)); 
        ksrav((void*) vect_i_e_pos+4*(2*(max/4)), (void*) xr_pos, (void*) 16);
        ksrav((void*) vect_j_e_pos+4*(max/4), (void*) xr_pos+4*(max/4), (void*) 16);
        kaddv((void*) vect_i_o_pos, (void*) vect_i_o_pos, (void*) vect_j_o_pos);
        kaddv((void*) vect_j_o_pos-4*(max/4), (void*) vect_i_o_pos+4*(max/4), (void*) vect_j_o_pos+4*(max/4));
        ksrav((void*) vect_i_o_pos+4*(2*(max/4)), (void*) xi_pos, (void*) 16);
        ksrav((void*) vect_j_o_pos+4*(max/4), (void*) xi_pos+4*(max/4), (void*) 16);
      }
      CSR_MVSIZE(4*max/2);
    }
    max >>= 1;
  }

  {
    int step = max/2 << 1;

    CSR_MVSIZE(4*128);

    ksubv((void*) tr, (void*) vect_i_e, (void*) vect_j_e); // spm_c = spm_a + spm_b
    ksubv((void*) ti, (void*) vect_i_o, (void*) vect_j_o); // spm_c = spm_a + spm_b

    kaddv((void*) vect_i_e, (void*) vect_i_e, (void*) vect_j_e);
    kaddv((void*) vect_i_o, (void*) vect_i_o, (void*) vect_j_o);
  }
  
  vect_j_e = tr;
  vect_j_o = ti;

  #if local_result == 1
    int *data_R_ptr = data_Rf_local+256*Klessydra_get_coreID();
    int *data_I_ptr = data_If_local+256*Klessydra_get_coreID();
  #else
    int *data_R_ptr = data_Rf+256*Klessydra_get_coreID();
    int *data_I_ptr = data_If+256*Klessydra_get_coreID();
  #endif

  kmemstr((void*) data_R_ptr,        (void*) vect_i_e, 4*128);
  kmemstr((void*) data_I_ptr,        (void*) vect_i_o, 4*128);
  kmemstr((void*) data_R_ptr+4*128,  (void*) vect_j_e, 4*128);
  kmemstr((void*) data_I_ptr+4*128,  (void*) vect_j_o, 4*128);

  #define SWAP(a, b) tmp=(a); (a)=(b); (b)=tmp

  int j = 1;
  for (int i = 1; i < len/2; i += 2) {
    if(j > i) {
      int tmp;

      int k = (i+1) & 3; // if k = 2, then we swap with the j_even vector else if k = 0 we swap with the i_even vector
      int l = (j+1) & 3; // if l = 2, then we swap with the j_odd vector else if l = 0 we swap with the i_odd vector
      int i_new = (i-1)/2;
      int j_new = ((j+1) >> 2) + ((l>>1))-1;

      if(j_new > i_new) {
        SWAP(data_R_ptr[j_new], data_R_ptr[i_new]);
        SWAP(data_I_ptr[j_new], data_I_ptr[i_new]);
        SWAP(data_R_ptr[j_new+128], data_R_ptr[i_new+128]);
        SWAP(data_I_ptr[j_new+128], data_I_ptr[i_new+128]);
      }
    }
    int m = len>> 1;
    while (m >= 2 && j >m) {
      j -= m;
      m >>= 1;
    }
    j += m;
  }
}
#endif

#if accl_test == 0
void fft(short *data, int len) {
  int max = len;
  len <<= 1;
  int wstep = 1;

  int while_loop_cnt = 0;
  while (max > 2) {
    short *wpr = wprBase;
    short *wpi = wpiBase;

    for (int m = 0; m < max; m +=2) {
      short wr = *wpr;
      short wi = *wpi;
      wpr+= wstep;
      wpi+= wstep;

      int step = max << 1;
      for (int i = m; i < len; i += step) {
        int j = i + max;
        short tr = data[i] - data[j];
        short ti = data[i+1] - data[j+1];

        data[i] += data[j];
        data[i+1] += data[j+1];

        int xr = ((wr * tr + wi * ti) << 1) + 0x8000;
        int xi = ((wr * ti - wi * tr) << 1) + 0x8000;

        data[j] = xr >> 16;
        data[j+1] = xi >> 16;
      }
    }
    max >>= 1;
    wstep <<= 1;
  }

  {
    int step = max << 1;
    for (int i = 0; i < len; i += step) {
      int j = i + max;

      short tr = data[i] - data[j];
      short ti = data[i+1] - data[j+1];

      data[i] += data[j];
      data[i+1] += data[j+1];

      data[j] = tr;
      data[j+1] = ti;

    }
  }


  #define SWAP(a, b) tmp=(a); (a)=(b); (b)=tmp

  data--;
  int j = 1;
  for (int i = 1; i < len; i += 2) {
    if(j > i) {
      short tmp;
      SWAP(data[j], data[i]);
      SWAP(data[j+1], data[i+1]);
    }
    int m = len>> 1;
    while (m >= 2 && j >m) {
      j -= m;
      m >>= 1;
    }
    j += m;
  }
}
#endif

// // --------------------------------------------------------------------------------------------------------------------------------
// // --------------------------------------------------------------------------------------------------------------------------------


//  ███╗   ███╗ █████╗ ████████╗███╗   ███╗██╗   ██╗██╗     
//  ████╗ ████║██╔══██╗╚══██╔══╝████╗ ████║██║   ██║██║     
//  ██╔████╔██║███████║   ██║   ██╔████╔██║██║   ██║██║     
//  ██║╚██╔╝██║██╔══██║   ██║   ██║╚██╔╝██║██║   ██║██║     
//  ██║ ╚═╝ ██║██║  ██║   ██║   ██║ ╚═╝ ██║╚██████╔╝███████╗
//  ╚═╝     ╚═╝╚═╝  ╚═╝   ╚═╝   ╚═╝     ╚═╝ ╚═════╝ ╚══════╝

//#if accl_test == 1
void matmul() {
  int n=N_ROW_1;
  int m=N_COL_1;
  int u=N_COL_2;
  int k,p;
  int scl=SPM_MAX*SPM_MAX/u;
  int offset[3]={0,0,0};
  //Matrix initialization
  int m_out[n][u];
  for(int i=0;i<n;i++){
    for(int j=0;j<u;j++){
      m_out[i][j]=0;
    }
  }
  //CSR_MVSIZE(u*SIZE_OF_INT);
  //for(int i=0;i<n;i++){
  //  k=0;
  //  p=0;
  //  kmemld((void *)((int *)spmaddrA), &m2[0][0],  SIZE_OF_INT*(u*scl));
  //  for(int j=0;j<m;j++){
  //    if((j%scl==0) & (j!=0)){
  //      p++;
  //      k=0;
  //      if(m-(p*scl)>scl){
  //        kmemld((void *)((int *)spmaddrA), &m2[j][0],  SIZE_OF_INT*(u*scl));
  //      }
  //      else{
  //        kmemld((void *)((int *)spmaddrA), &m2[j][0],  SIZE_OF_INT*((m-scl*p)*u));
  //      }
  //    }
  //    offset[1]=k*u;
  //    ksvmulrf((void *)((int *)spmaddrC),(void *)((int *)spmaddrA+offset[1]),(void*) m1[i][j]);
  //    kaddv((void *)((int *)spmaddrB),(void *)((int *)spmaddrB),(void *)((int *)spmaddrC));
  //    k++;
  //  }
  //  kmemstr(&m_out[i][0],  (void *)((int *)spmaddrB),  u*SIZE_OF_INT);
  //  kbcast((void *)((int *)spmaddrB),(void *)zero);
  //}

  CSR_MVSIZE(u*SIZE_OF_INT);
  scl=SPM_MAX*SPM_MAX/(3*u);
  for(int i=0;i<n;i++){
  	k=0;
  	p=0;
  	kmemld((void *)((int *)spmaddrA+u*scl+u*scl), &m2[0][0],  SIZE_OF_INT*(u*scl));
  	for(int j=0;j<m;j++){
  		if(j%scl==0 & j!=0){
  			p++;
  			k=0;
  			if(m-(p*scl)>scl){
  				kmemld((void *)((int *)spmaddrA+u*scl+u*scl), &m2[j][0],  SIZE_OF_INT*(u*scl));
  			}
  			else{
  				kmemld((void *)((int *)spmaddrA+u*scl+u*scl), &m2[j][0],  SIZE_OF_INT*((m-scl*p)*u));
  			}
  		}
  		offset[1]=k*u+u*scl+u*scl;
  		ksvmulrf((void *)((int *)spmaddrC+u+u),(void *)((int *)spmaddrA+offset[1]),m1[i][j]);
  		kaddv((void *)((int *)spmaddrB+u+u),(void *)((int *)spmaddrB+u+u),(void *)((int *)spmaddrC+u+u));
  		k++;
  	}
  	kmemstr(&m_out[i][0],  (void *)((int *)spmaddrB+u+u),  u*SIZE_OF_INT);
  	kbcast((void *)((int *)spmaddrB+u+u),(void *)zero);
  }
}
//#endif

//#if accl_test == 0
//void matmul() {
//  int n=N_ROW_1;
//  int m=N_COL_1;
//  int u=N_COL_2;
//  int vect[u];
//  int k,p;
//  int m_out[n][u];
//  for(int i=0;i<n;i++){
//  	for(int j=0;j<u;j++){
//  		m_out[i][j]=0;
//  		vect[j]=0;
//  	}
//  }
//  for(int i=0;i<n;i++){
//  	for(int j=0;j<m;j++){
//  		for(int k=0;k<u;k++){
//  			vect[k]+=m1[i][j]*m2[j][k];
//  		}
//  		
//  	}
//  	for(int j=0;j<u;j++){
//  		m_out[i][j]=vect[j];
//  		vect[j]=0;
//  	}
//  }
//}
//#endif


// // --------------------------------------------------------------------------------------------------------------------------------
// // --------------------------------------------------------------------------------------------------------------------------------